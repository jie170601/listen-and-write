"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const WordGroup_1 = require("../beans/WordGroup");
const Params_1 = require("../beans/Params");
class StorageUtil {
    static addWordGroup(wordGroup) {
        let wordGroupList = this.getWordGroup();
        wordGroupList.unshift(wordGroup);
        this.saveWordGroupList(wordGroupList);
    }
    static getWordGroup() {
        let wordGroupList = wx.getStorageSync('wordGroupList');
        if (!wordGroupList) {
            return new Array();
        }
        let list = new Array();
        for (let i = 0; i < wordGroupList.length; i++) {
            let wordGroup = new WordGroup_1.WordGroup();
            wordGroup.setCount(wordGroupList[i].count);
            wordGroup.setId(wordGroupList[i].id);
            wordGroup.setName(wordGroupList[i].name);
            wordGroup.setList(wordGroupList[i].list);
            list.push(wordGroup);
        }
        return list;
    }
    static deleteWordGroup(wordGroup) {
        let wordGroupList = this.getWordGroup();
        let groupListTemp = new Array();
        for (let i = 0; i < wordGroupList.length; i++) {
            if (wordGroupList[i].getId() !== wordGroup.getId()) {
                groupListTemp.push(wordGroupList[i]);
            }
        }
        this.saveWordGroupList(groupListTemp);
    }
    static addWord(wordGroup, word) {
        let wordGroupList = this.getWordGroup();
        for (let i = 0; i < wordGroupList.length; i++) {
            if (wordGroupList[i].getId() === wordGroup.getId()) {
                let wordList = wordGroupList[i].getList();
                wordList.unshift(word);
                wordGroupList[i].setList(wordList);
                wordGroupList[i].setCount(wordList.length);
                this.saveWordGroupList(wordGroupList);
                return;
            }
        }
    }
    static deleteWord(wordGroup, word) {
        let wordGroupList = this.getWordGroup();
        for (let i = 0; i < wordGroupList.length; i++) {
            if (wordGroupList[i].getId() === wordGroup.getId()) {
                let wordList = wordGroupList[i].getList();
                let wordListTemp = new Array();
                for (let j = 0; j < wordList.length; j++) {
                    if (wordList[j] !== word) {
                        wordListTemp.push(wordList[j]);
                    }
                }
                wordGroupList[i].setList(wordListTemp);
                wordGroupList[i].setCount(wordListTemp.length);
                this.saveWordGroupList(wordGroupList);
                return;
            }
        }
    }
    static saveWordGroupList(wordGroupList) {
        wx.setStorageSync('wordGroupList', wordGroupList);
    }
    static setParams(params) {
        wx.setStorageSync("params", params);
    }
    static getParams() {
        let paramsObject = wx.getStorageSync("params");
        let params = new Params_1.Params();
        if (typeof paramsObject === 'object') {
            params.setSpeed(paramsObject.speed);
            params.setRepeat(paramsObject.repeat);
            params.setInterval(paramsObject.interval);
            params.setPause(paramsObject.pause);
            if (paramsObject.mode === 0) {
                params.setMode(Params_1.Mode.RANDOM);
            }
            if (paramsObject.mode === 1) {
                params.setMode(Params_1.Mode.ORDER);
            }
            if (paramsObject.pron === 0) {
                params.setPron(Params_1.Pronunciation.BRITISH);
            }
            if (paramsObject.pron === 1) {
                params.setPron(Params_1.Pronunciation.AMERICAN);
            }
        }
        return params;
    }
}
exports.StorageUtil = StorageUtil;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RvcmFnZVV0aWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJTdG9yYWdlVXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQWVBLGtEQUE4QztBQUU5Qyw0Q0FBeUQ7QUFFekQsTUFBYSxXQUFXO0lBUWYsTUFBTSxDQUFDLFlBQVksQ0FBQyxTQUFvQjtRQUM3QyxJQUFJLGFBQWEsR0FBcUIsSUFBSSxDQUFDLFlBQVksRUFBRSxDQUFBO1FBQ3pELGFBQWEsQ0FBQyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUE7UUFDaEMsSUFBSSxDQUFDLGlCQUFpQixDQUFDLGFBQWEsQ0FBQyxDQUFBO0lBQ3ZDLENBQUM7SUFRTSxNQUFNLENBQUMsWUFBWTtRQUN4QixJQUFJLGFBQWEsR0FBYyxFQUFFLENBQUMsY0FBYyxDQUFDLGVBQWUsQ0FBQyxDQUFBO1FBQ2pFLElBQUcsQ0FBQyxhQUFhLEVBQUM7WUFDaEIsT0FBTyxJQUFJLEtBQUssRUFBYSxDQUFBO1NBQzlCO1FBS0QsSUFBSSxJQUFJLEdBQW9CLElBQUksS0FBSyxFQUFhLENBQUE7UUFDbEQsS0FBSSxJQUFJLENBQUMsR0FBQyxDQUFDLEVBQUMsQ0FBQyxHQUFDLGFBQWEsQ0FBQyxNQUFNLEVBQUMsQ0FBQyxFQUFFLEVBQUM7WUFDckMsSUFBSSxTQUFTLEdBQWEsSUFBSSxxQkFBUyxFQUFFLENBQUE7WUFDekMsU0FBUyxDQUFDLFFBQVEsQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLENBQUE7WUFDMUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUE7WUFDcEMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUE7WUFDeEMsU0FBUyxDQUFDLE9BQU8sQ0FBQyxhQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLENBQUE7WUFDeEMsSUFBSSxD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O1NBQ0Y7UUFDRCxPQUFPLE1BQU0sQ0FBQTtJQUNmLENBQUM7Q0FDRjtBQWhJRCxrQ0FnSUMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICog57yT5a2Y5pON5L2c57G7XHJcbiAqIFxyXG4gKiDkuLrku4DkuYjopoHmiorljZXor43lrZjlnKjmnKzlnLDvvJ9cclxuICogLeWboOS4uuayoemSseS5sOacjeWKoeWZqO+8gVxyXG4gKiBcclxuICog5bCP56iL5bqP5pyJ5YWN6LS555qE5LqR5pWw5o2u5bqT5LqG5Li65LuA5LmI5LiN55So77yfXHJcbiAqIC3lm6DkuLrmh5LvvIHpgqPmoLfov5jlvpflvIDlj5HkuIDns7vliJfnmoTnlKjmiLfnrqHnkIbllaXnmoTjgIJcclxuICogLeWPquaDs+aKiuWQrOWGmeWKn+iDveWBmuWlve+8geWFtuWug+WKn+iDveaDs+imgeeahOWPr+S7peiHquW3seWBmu+8jOaJgOS7peW8gOa6kOS6hu+8gVxyXG4gKiBcclxuICog5a2Y5Zyo5pys5Zyw55yf55qE5rKh6Zeu6aKY5ZCX77yfXHJcbiAqIC3mnInpl67popjnmoTvvIzmr5TlpoLlvq7kv6HkuI3pq5jlhbTkuoblsLHmuIXnvJPlrZjvvIzkv53lrZjnmoTljZXor43lsLHlhajmsqHkuobvvIFcclxuICogLeavj+S4quWwj+eoi+W6j+WPquaciTEwTULnmoTnvJPlrZjnqbrpl7TvvIzlr7notoXnuqflrabpnLjmnaXor7Tlj6/og73kuI3lpJ/nlKjvvIFcclxuICovXHJcblxyXG5pbXBvcnQgeyBXb3JkR3JvdXAgfSBmcm9tICcuLi9iZWFucy9Xb3JkR3JvdXAnXHJcbmltcG9ydCB7IFdvcmQgfSBmcm9tICcuLi9iZWFucy9Xb3JkJ1xyXG5pbXBvcnQge1BhcmFtcyxNb2RlLFByb251bmNpYXRpb259IGZyb20gJy4uL2JlYW5zL1BhcmFtcydcclxuXHJcbmV4cG9ydCBjbGFzcyBTdG9yYWdlVXRpbHtcclxuXHJcbiAgLyoqXHJcbiAgICog5re75Yqg5YiG57uEXHJcbiAgICog5pa55rOV5piv5YWI6I635Y+W5b2T5YmN55qE5Y2V6K+N5YiG57uE5pWw57uEXHJcbiAgICog5YaN5b6A5pWw57uE6YeMcHVzaOimgea3u+WKoOeahOWIhue7hFxyXG4gICAqIOWGjeaKinB1c2jlkI7nmoTmlbDnu4Tkv53lrZjkvJrnvJPlrZhcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGFkZFdvcmRHcm91cCh3b3JkR3JvdXA6IFdvcmRHcm91cCk6IHZvaWQge1xyXG4gICAgbGV0IHdvcmRHcm91cExpc3Q6IEFycmF5PFdvcmRHcm91cD4gPSB0aGlzLmdldFdvcmRHcm91cCgpXHJcbiAgICB3b3JkR3JvdXBMaXN0LnVuc2hpZnQod29yZEdyb3VwKVxyXG4gICAgdGhpcy5zYXZlV29yZEdyb3VwTGlzdCh3b3JkR3JvdXBMaXN0KVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog6I635Y+W5omA5pyJ55qE5Y2V6K+N5YiG57uEXHJcbiAgICog5aaC5p6c5rKh5pyJ5Lu75L2V55qE5Y2V6K+N5YiG57uEXHJcbiAgICog5oiW6ICF6I635Y+W5aSx6LSlXHJcbiAgICog5YiZ6L+U5Zue56m65pWw57uEXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBnZXRXb3JkR3JvdXAoKTpBcnJheTxXb3JkR3JvdXA+e1xyXG4gICAgbGV0IHdvcmRHcm91cExpc3Q6QXJyYXk8YW55PiA9IHd4LmdldFN0b3JhZ2VTeW5jKCd3b3JkR3JvdXBMaXN0JylcclxuICAgIGlmKCF3b3JkR3JvdXBMaXN0KXtcclxuICAgICAgcmV0dXJuIG5ldyBBcnJheTxXb3JkR3JvdXA+KClcclxuICAgIH1cclxuICAgIC8v6L+Z6YeM5rOo5oSP5LqGXHJcbiAgICAvL+S4jeaYr+WPqueugOWNlei/lOWbnue8k+WtmOeahGxpc3RcclxuICAgIC8v5a6e6Le16K+B5piO57yT5a2Y6YeM6Z2i5a2Y55qE5a+56LGh5Lya5Lii5aSx5pa55rOVXHJcbiAgICAvL+aJgOS7peimgeaKiue8k+WtmOWPluWHuueahGxpc3TlsIHoo4XliLBXb3JkR3JvdXBMaXN05LitXHJcbiAgICBsZXQgbGlzdDpBcnJheTxXb3JkR3JvdXA+ID0gbmV3IEFycmF5PFdvcmRHcm91cD4oKVxyXG4gICAgZm9yKGxldCBpPTA7aTx3b3JkR3JvdXBMaXN0Lmxlbmd0aDtpKyspe1xyXG4gICAgICBsZXQgd29yZEdyb3VwOldvcmRHcm91cCA9IG5ldyBXb3JkR3JvdXAoKVxyXG4gICAgICB3b3JkR3JvdXAuc2V0Q291bnQod29yZEdyb3VwTGlzdFtpXS5jb3VudClcclxuICAgICAgd29yZEdyb3VwLnNldElkKHdvcmRHcm91cExpc3RbaV0uaWQpXHJcbiAgICAgIHdvcmRHcm91cC5zZXROYW1lKHdvcmRHcm91cExpc3RbaV0ubmFtZSlcclxuICAgICAgd29yZEdyb3VwLnNldExpc3Qod29yZEdyb3VwTGlzdFtpXS5saXN0KVxyXG4gICAgICBsaXN0LnB1c2god29yZEdyb3VwKVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIGxpc3RcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWIoOmZpOWNleivjeWIhue7hFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZGVsZXRlV29yZEdyb3VwKHdvcmRHcm91cDpXb3JkR3JvdXApOiB2b2lkIHtcclxuICAgIGxldCB3b3JkR3JvdXBMaXN0OiBBcnJheTxXb3JkR3JvdXA+ID0gdGhpcy5nZXRXb3JkR3JvdXAoKVxyXG4gICAgbGV0IGdyb3VwTGlzdFRlbXA6IEFycmF5PFdvcmRHcm91cD4gPSBuZXcgQXJyYXk8V29yZEdyb3VwPigpXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmRHcm91cExpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKHdvcmRHcm91cExpc3RbaV0uZ2V0SWQoKSE9PXdvcmRHcm91cC5nZXRJZCgpKSB7XHJcbiAgICAgICAgZ3JvdXBMaXN0VGVtcC5wdXNoKHdvcmRHcm91cExpc3RbaV0pO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLnNhdmVXb3JkR3JvdXBMaXN0KGdyb3VwTGlzdFRlbXApXHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDlvoDljZXor43liIbnu4TkuIvmt7vliqDljZXor41cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGFkZFdvcmQod29yZEdyb3VwOldvcmRHcm91cCx3b3JkOldvcmQpOnZvaWR7XHJcbiAgICBsZXQgd29yZEdyb3VwTGlzdDogQXJyYXk8V29yZEdyb3VwPiA9IHRoaXMuZ2V0V29yZEdyb3VwKClcclxuICAgIGZvcihsZXQgaT0wO2k8d29yZEdyb3VwTGlzdC5sZW5ndGg7aSsrKXtcclxuICAgICAgaWYod29yZEdyb3VwTGlzdFtpXS5nZXRJZCgpPT09d29yZEdyb3VwLmdldElkKCkpe1xyXG4gICAgICAgIGxldCB3b3JkTGlzdDogQXJyYXk8V29yZD4gPSB3b3JkR3JvdXBMaXN0W2ldLmdldExpc3QoKVxyXG4gICAgICAgIHdvcmRMaXN0LnVuc2hpZnQod29yZClcclxuICAgICAgICB3b3JkR3JvdXBMaXN0W2ldLnNldExpc3Qod29yZExpc3QpXHJcbiAgICAgICAgd29yZEdyb3VwTGlzdFtpXS5zZXRDb3VudCh3b3JkTGlzdC5sZW5ndGgpXHJcbiAgICAgICAgdGhpcy5zYXZlV29yZEdyb3VwTGlzdCh3b3JkR3JvdXBMaXN0KVxyXG4gICAgICAgIHJldHVyblxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliKDpmaTljZXor43liIbnu4TkuIvnmoTmjIflrprljZXor41cclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGRlbGV0ZVdvcmQod29yZEdyb3VwOldvcmRHcm91cCx3b3JkOldvcmQpOnZvaWR7XHJcbiAgICBsZXQgd29yZEdyb3VwTGlzdDogQXJyYXk8V29yZEdyb3VwPiA9IHRoaXMuZ2V0V29yZEdyb3VwKClcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgd29yZEdyb3VwTGlzdC5sZW5ndGg7IGkrKykge1xyXG4gICAgICBpZiAod29yZEdyb3VwTGlzdFtpXS5nZXRJZCgpID09PSB3b3JkR3JvdXAuZ2V0SWQoKSkge1xyXG4gICAgICAgIGxldCB3b3JkTGlzdDogQXJyYXk8V29yZD4gPSB3b3JkR3JvdXBMaXN0W2ldLmdldExpc3QoKVxyXG4gICAgICAgIGxldCB3b3JkTGlzdFRlbXA6IEFycmF5PFdvcmQ+ID0gbmV3IEFycmF5PFdvcmQ+KClcclxuICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHdvcmRMaXN0Lmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICBpZiAod29yZExpc3Rbal0gIT09IHdvcmQpIHtcclxuICAgICAgICAgICAgd29yZExpc3RUZW1wLnB1c2god29yZExpc3Rbal0pXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHdvcmRHcm91cExpc3RbaV0uc2V0TGlzdCh3b3JkTGlzdFRlbXApXHJcbiAgICAgICAgd29yZEdyb3VwTGlzdFtpXS5zZXRDb3VudCh3b3JkTGlzdFRlbXAubGVuZ3RoKVxyXG4gICAgICAgIHRoaXMuc2F2ZVdvcmRHcm91cExpc3Qod29yZEdyb3VwTGlzdClcclxuICAgICAgICByZXR1cm5cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5bCG5Y2V6K+N5YiX6KGo5L+d5a2Y5Yiw57yT5a2YXHJcbiAgICovXHJcbiAgcHJpdmF0ZSBzdGF0aWMgc2F2ZVdvcmRHcm91cExpc3Qod29yZEdyb3VwTGlzdDpBcnJheTxXb3JkR3JvdXA+KTp2b2lke1xyXG4gICAgd3guc2V0U3RvcmFnZVN5bmMoJ3dvcmRHcm91cExpc3QnLHdvcmRHcm91cExpc3QpXHJcbiAgfVxyXG5cclxuICAvKioqKioqKioqKioqKiDns7vnu5/lj4LmlbDmk43kvZwgKioqKioqKioqKioqKiovXHJcbiAgcHVibGljIHN0YXRpYyBzZXRQYXJhbXMocGFyYW1zOiBQYXJhbXMpOiB2b2lkIHtcclxuICAgIHd4LnNldFN0b3JhZ2VTeW5jKFwicGFyYW1zXCIscGFyYW1zKVxyXG4gIH1cclxuICBwdWJsaWMgc3RhdGljIGdldFBhcmFtcygpOlBhcmFtc3tcclxuICAgIGxldCBwYXJhbXNPYmplY3Q6YW55ID0gd3guZ2V0U3RvcmFnZVN5bmMoXCJwYXJhbXNcIilcclxuICAgIGxldCBwYXJhbXM6UGFyYW1zID0gbmV3IFBhcmFtcygpXHJcbiAgICBpZih0eXBlb2YgcGFyYW1zT2JqZWN0ID09PSAnb2JqZWN0Jyl7XHJcbiAgICAgIHBhcmFtcy5zZXRTcGVlZChwYXJhbXNPYmplY3Quc3BlZWQpXHJcbiAgICAgIHBhcmFtcy5zZXRSZXBlYXQocGFyYW1zT2JqZWN0LnJlcGVhdClcclxuICAgICAgcGFyYW1zLnNldEludGVydmFsKHBhcmFtc09iamVjdC5pbnRlcnZhbClcclxuICAgICAgcGFyYW1zLnNldFBhdXNlKHBhcmFtc09iamVjdC5wYXVzZSlcclxuICAgICAgaWYgKHBhcmFtc09iamVjdC5tb2RlID09PSAwKSB7XHJcbiAgICAgICAgcGFyYW1zLnNldE1vZGUoTW9kZS5SQU5ET00pXHJcbiAgICAgIH1cclxuICAgICAgaWYgKHBhcmFtc09iamVjdC5tb2RlID09PSAxKSB7XHJcbiAgICAgICAgcGFyYW1zLnNldE1vZGUoTW9kZS5PUkRFUilcclxuICAgICAgfVxyXG4gICAgICBpZiAocGFyYW1zT2JqZWN0LnByb24gPT09IDApIHtcclxuICAgICAgICBwYXJhbXMuc2V0UHJvbihQcm9udW5jaWF0aW9uLkJSSVRJU0gpXHJcbiAgICAgIH1cclxuICAgICAgaWYgKHBhcmFtc09iamVjdC5wcm9uID09PSAxKSB7XHJcbiAgICAgICAgcGFyYW1zLnNldFByb24oUHJvbnVuY2lhdGlvbi5BTUVSSUNBTilcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgcmV0dXJuIHBhcmFtc1xyXG4gIH1cclxufSJdfQ==
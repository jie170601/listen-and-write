"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var WordGroup_1 = require("../beans/WordGroup");
var Params_1 = require("../beans/Params");
var StorageUtil = (function () {
    function StorageUtil() {
    }
    StorageUtil.addWordGroup = function (wordGroup) {
        var wordGroupList = this.getWordGroup();
        wordGroupList.unshift(wordGroup);
        this.saveWordGroupList(wordGroupList);
    };
    StorageUtil.getWordGroup = function () {
        var wordGroupList = wx.getStorageSync('wordGroupList');
        if (!wordGroupList) {
            return new Array();
        }
        var list = new Array();
        for (var i = 0; i < wordGroupList.length; i++) {
            var wordGroup = new WordGroup_1.WordGroup();
            wordGroup.setCount(wordGroupList[i].count);
            wordGroup.setId(wordGroupList[i].id);
            wordGroup.setName(wordGroupList[i].name);
            wordGroup.setList(wordGroupList[i].list);
            list.push(wordGroup);
        }
        return list;
    };
    StorageUtil.deleteWordGroup = function (wordGroup) {
        var wordGroupList = this.getWordGroup();
        var groupListTemp = new Array();
        for (var i = 0; i < wordGroupList.length; i++) {
            if (wordGroupList[i].getId() !== wordGroup.getId()) {
                groupListTemp.push(wordGroupList[i]);
            }
        }
        this.saveWordGroupList(groupListTemp);
    };
    StorageUtil.addWord = function (wordGroup, word) {
        var wordGroupList = this.getWordGroup();
        for (var i = 0; i < wordGroupList.length; i++) {
            if (wordGroupList[i].getId() === wordGroup.getId()) {
                var wordList = wordGroupList[i].getList();
                wordList.unshift(word);
                wordGroupList[i].setList(wordList);
                wordGroupList[i].setCount(wordList.length);
                this.saveWordGroupList(wordGroupList);
                return;
            }
        }
    };
    StorageUtil.deleteWord = function (wordGroup, word) {
        var wordGroupList = this.getWordGroup();
        for (var i = 0; i < wordGroupList.length; i++) {
            if (wordGroupList[i].getId() === wordGroup.getId()) {
                var wordList = wordGroupList[i].getList();
                var wordListTemp = new Array();
                for (var j = 0; j < wordList.length; j++) {
                    if (wordList[j] !== word) {
                        wordListTemp.push(wordList[j]);
                    }
                }
                wordGroupList[i].setList(wordListTemp);
                wordGroupList[i].setCount(wordListTemp.length);
                this.saveWordGroupList(wordGroupList);
                return;
            }
        }
    };
    StorageUtil.saveWordGroupList = function (wordGroupList) {
        wx.setStorageSync('wordGroupList', wordGroupList);
    };
    StorageUtil.setParams = function (params) {
        wx.setStorageSync("params", params);
    };
    StorageUtil.getParams = function () {
        var paramsObject = wx.getStorageSync("params");
        var params = new Params_1.Params();
        if (typeof paramsObject === 'object') {
            params.setSpeed(paramsObject.speed);
            params.setRepeat(paramsObject.repeat);
            params.setInterval(paramsObject.interval);
            params.setPause(paramsObject.pause);
            if (paramsObject.mode === 0) {
                params.setMode(Params_1.Mode.RANDOM);
            }
            if (paramsObject.mode === 1) {
                params.setMode(Params_1.Mode.ORDER);
            }
            if (paramsObject.pron === 0) {
                params.setPron(Params_1.Pronunciation.BRITISH);
            }
            if (paramsObject.pron === 1) {
                params.setPron(Params_1.Pronunciation.AMERICAN);
            }
        }
        return params;
    };
    return StorageUtil;
}());
exports.StorageUtil = StorageUtil;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiU3RvcmFnZVV0aWwuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJTdG9yYWdlVXRpbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQWVBLGdEQUE4QztBQUU5QywwQ0FBeUQ7QUFFekQ7SUFBQTtJQWdJQSxDQUFDO0lBeEhlLHdCQUFZLEdBQTFCLFVBQTJCLFNBQW9CO1FBQzdDLElBQUksYUFBYSxHQUFxQixJQUFJLENBQUMsWUFBWSxFQUFFLENBQUE7UUFDekQsYUFBYSxDQUFDLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQTtRQUNoQyxJQUFJLENBQUMsaUJBQWlCLENBQUMsYUFBYSxDQUFDLENBQUE7SUFDdkMsQ0FBQztJQVFhLHdCQUFZLEdBQTFCO1FBQ0UsSUFBSSxhQUFhLEdBQWMsRUFBRSxDQUFDLGNBQWMsQ0FBQyxlQUFlLENBQUMsQ0FBQTtRQUNqRSxJQUFHLENBQUMsYUFBYSxFQUFDO1lBQ2hCLE9BQU8sSUFBSSxLQUFLLEVBQWEsQ0FBQTtTQUM5QjtRQUtELElBQUksSUFBSSxHQUFvQixJQUFJLEtBQUssRUFBYSxDQUFBO1FBQ2xELEtBQUksSUFBSSxDQUFDLEdBQUMsQ0FBQyxFQUFDLENBQUMsR0FBQyxhQUFhLENBQUMsTUFBTSxFQUFDLENBQUMsRUFBRSxFQUFDO1lBQ3JDLElBQUksU0FBUyxHQUFhLElBQUkscUJBQVMsRUFBRSxDQUFBO1lBQ3pDLFNBQVMsQ0FBQyxRQUFRLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFBO1lBQzFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFBO1lBQ3BDLFNBQVMsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFBO1lBQ3hDLFNBQVMsQ0FBQyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFBO1lBQ3hDLElBQUks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TyxNQUFNLENBQUE7SUFDZixDQUFDO0lBQ0gsa0JBQUM7QUFBRCxDQUFDLEFBaElELElBZ0lDO0FBaElZLGtDQUFXIiwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIOe8k+WtmOaTjeS9nOexu1xyXG4gKiBcclxuICog5Li65LuA5LmI6KaB5oqK5Y2V6K+N5a2Y5Zyo5pys5Zyw77yfXHJcbiAqIC3lm6DkuLrmsqHpkrHkubDmnI3liqHlmajvvIFcclxuICogXHJcbiAqIOWwj+eoi+W6j+acieWFjei0ueeahOS6keaVsOaNruW6k+S6huS4uuS7gOS5iOS4jeeUqO+8n1xyXG4gKiAt5Zug5Li65oeS77yB6YKj5qC36L+Y5b6X5byA5Y+R5LiA57O75YiX55qE55So5oi3566h55CG5ZWl55qE44CCXHJcbiAqIC3lj6rmg7PmiorlkKzlhpnlip/og73lgZrlpb3vvIHlhbblroPlip/og73mg7PopoHnmoTlj6/ku6Xoh6rlt7HlgZrvvIzmiYDku6XlvIDmupDkuobvvIFcclxuICogXHJcbiAqIOWtmOWcqOacrOWcsOecn+eahOayoemXrumimOWQl++8n1xyXG4gKiAt5pyJ6Zeu6aKY55qE77yM5q+U5aaC5b6u5L+h5LiN6auY5YW05LqG5bCx5riF57yT5a2Y77yM5L+d5a2Y55qE5Y2V6K+N5bCx5YWo5rKh5LqG77yBXHJcbiAqIC3mr4/kuKrlsI/nqIvluo/lj6rmnIkxME1C55qE57yT5a2Y56m66Ze077yM5a+56LaF57qn5a2m6Zy45p2l6K+05Y+v6IO95LiN5aSf55So77yBXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgV29yZEdyb3VwIH0gZnJvbSAnLi4vYmVhbnMvV29yZEdyb3VwJ1xyXG5pbXBvcnQgeyBXb3JkIH0gZnJvbSAnLi4vYmVhbnMvV29yZCdcclxuaW1wb3J0IHtQYXJhbXMsTW9kZSxQcm9udW5jaWF0aW9ufSBmcm9tICcuLi9iZWFucy9QYXJhbXMnXHJcblxyXG5leHBvcnQgY2xhc3MgU3RvcmFnZVV0aWx7XHJcblxyXG4gIC8qKlxyXG4gICAqIOa3u+WKoOWIhue7hFxyXG4gICAqIOaWueazleaYr+WFiOiOt+WPluW9k+WJjeeahOWNleivjeWIhue7hOaVsOe7hFxyXG4gICAqIOWGjeW+gOaVsOe7hOmHjHB1c2jopoHmt7vliqDnmoTliIbnu4RcclxuICAgKiDlho3miopwdXNo5ZCO55qE5pWw57uE5L+d5a2Y5Lya57yT5a2YXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBhZGRXb3JkR3JvdXAod29yZEdyb3VwOiBXb3JkR3JvdXApOiB2b2lkIHtcclxuICAgIGxldCB3b3JkR3JvdXBMaXN0OiBBcnJheTxXb3JkR3JvdXA+ID0gdGhpcy5nZXRXb3JkR3JvdXAoKVxyXG4gICAgd29yZEdyb3VwTGlzdC51bnNoaWZ0KHdvcmRHcm91cClcclxuICAgIHRoaXMuc2F2ZVdvcmRHcm91cExpc3Qod29yZEdyb3VwTGlzdClcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOiOt+WPluaJgOacieeahOWNleivjeWIhue7hFxyXG4gICAqIOWmguaenOayoeacieS7u+S9leeahOWNleivjeWIhue7hFxyXG4gICAqIOaIluiAheiOt+WPluWksei0pVxyXG4gICAqIOWImei/lOWbnuepuuaVsOe7hFxyXG4gICAqL1xyXG4gIHB1YmxpYyBzdGF0aWMgZ2V0V29yZEdyb3VwKCk6QXJyYXk8V29yZEdyb3VwPntcclxuICAgIGxldCB3b3JkR3JvdXBMaXN0OkFycmF5PGFueT4gPSB3eC5nZXRTdG9yYWdlU3luYygnd29yZEdyb3VwTGlzdCcpXHJcbiAgICBpZighd29yZEdyb3VwTGlzdCl7XHJcbiAgICAgIHJldHVybiBuZXcgQXJyYXk8V29yZEdyb3VwPigpXHJcbiAgICB9XHJcbiAgICAvL+i/memHjOazqOaEj+S6hlxyXG4gICAgLy/kuI3mmK/lj6rnroDljZXov5Tlm57nvJPlrZjnmoRsaXN0XHJcbiAgICAvL+Wunui3teivgeaYjue8k+WtmOmHjOmdouWtmOeahOWvueixoeS8muS4ouWkseaWueazlVxyXG4gICAgLy/miYDku6XopoHmiornvJPlrZjlj5blh7rnmoRsaXN05bCB6KOF5YiwV29yZEdyb3VwTGlzdOS4rVxyXG4gICAgbGV0IGxpc3Q6QXJyYXk8V29yZEdyb3VwPiA9IG5ldyBBcnJheTxXb3JkR3JvdXA+KClcclxuICAgIGZvcihsZXQgaT0wO2k8d29yZEdyb3VwTGlzdC5sZW5ndGg7aSsrKXtcclxuICAgICAgbGV0IHdvcmRHcm91cDpXb3JkR3JvdXAgPSBuZXcgV29yZEdyb3VwKClcclxuICAgICAgd29yZEdyb3VwLnNldENvdW50KHdvcmRHcm91cExpc3RbaV0uY291bnQpXHJcbiAgICAgIHdvcmRHcm91cC5zZXRJZCh3b3JkR3JvdXBMaXN0W2ldLmlkKVxyXG4gICAgICB3b3JkR3JvdXAuc2V0TmFtZSh3b3JkR3JvdXBMaXN0W2ldLm5hbWUpXHJcbiAgICAgIHdvcmRHcm91cC5zZXRMaXN0KHdvcmRHcm91cExpc3RbaV0ubGlzdClcclxuICAgICAgbGlzdC5wdXNoKHdvcmRHcm91cClcclxuICAgIH1cclxuICAgIHJldHVybiBsaXN0XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiDliKDpmaTljZXor43liIbnu4RcclxuICAgKi9cclxuICBwdWJsaWMgc3RhdGljIGRlbGV0ZVdvcmRHcm91cCh3b3JkR3JvdXA6V29yZEdyb3VwKTogdm9pZCB7XHJcbiAgICBsZXQgd29yZEdyb3VwTGlzdDogQXJyYXk8V29yZEdyb3VwPiA9IHRoaXMuZ2V0V29yZEdyb3VwKClcclxuICAgIGxldCBncm91cExpc3RUZW1wOiBBcnJheTxXb3JkR3JvdXA+ID0gbmV3IEFycmF5PFdvcmRHcm91cD4oKVxyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB3b3JkR3JvdXBMaXN0Lmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGlmICh3b3JkR3JvdXBMaXN0W2ldLmdldElkKCkhPT13b3JkR3JvdXAuZ2V0SWQoKSkge1xyXG4gICAgICAgIGdyb3VwTGlzdFRlbXAucHVzaCh3b3JkR3JvdXBMaXN0W2ldKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy5zYXZlV29yZEdyb3VwTGlzdChncm91cExpc3RUZW1wKVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5b6A5Y2V6K+N5YiG57uE5LiL5re75Yqg5Y2V6K+NXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBhZGRXb3JkKHdvcmRHcm91cDpXb3JkR3JvdXAsd29yZDpXb3JkKTp2b2lke1xyXG4gICAgbGV0IHdvcmRHcm91cExpc3Q6IEFycmF5PFdvcmRHcm91cD4gPSB0aGlzLmdldFdvcmRHcm91cCgpXHJcbiAgICBmb3IobGV0IGk9MDtpPHdvcmRHcm91cExpc3QubGVuZ3RoO2krKyl7XHJcbiAgICAgIGlmKHdvcmRHcm91cExpc3RbaV0uZ2V0SWQoKT09PXdvcmRHcm91cC5nZXRJZCgpKXtcclxuICAgICAgICBsZXQgd29yZExpc3Q6IEFycmF5PFdvcmQ+ID0gd29yZEdyb3VwTGlzdFtpXS5nZXRMaXN0KClcclxuICAgICAgICB3b3JkTGlzdC51bnNoaWZ0KHdvcmQpXHJcbiAgICAgICAgd29yZEdyb3VwTGlzdFtpXS5zZXRMaXN0KHdvcmRMaXN0KVxyXG4gICAgICAgIHdvcmRHcm91cExpc3RbaV0uc2V0Q291bnQod29yZExpc3QubGVuZ3RoKVxyXG4gICAgICAgIHRoaXMuc2F2ZVdvcmRHcm91cExpc3Qod29yZEdyb3VwTGlzdClcclxuICAgICAgICByZXR1cm5cclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICog5Yig6Zmk5Y2V6K+N5YiG57uE5LiL55qE5oyH5a6a5Y2V6K+NXHJcbiAgICovXHJcbiAgcHVibGljIHN0YXRpYyBkZWxldGVXb3JkKHdvcmRHcm91cDpXb3JkR3JvdXAsd29yZDpXb3JkKTp2b2lke1xyXG4gICAgbGV0IHdvcmRHcm91cExpc3Q6IEFycmF5PFdvcmRHcm91cD4gPSB0aGlzLmdldFdvcmRHcm91cCgpXHJcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IHdvcmRHcm91cExpc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgaWYgKHdvcmRHcm91cExpc3RbaV0uZ2V0SWQoKSA9PT0gd29yZEdyb3VwLmdldElkKCkpIHtcclxuICAgICAgICBsZXQgd29yZExpc3Q6IEFycmF5PFdvcmQ+ID0gd29yZEdyb3VwTGlzdFtpXS5nZXRMaXN0KClcclxuICAgICAgICBsZXQgd29yZExpc3RUZW1wOiBBcnJheTxXb3JkPiA9IG5ldyBBcnJheTxXb3JkPigpXHJcbiAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB3b3JkTGlzdC5sZW5ndGg7IGorKykge1xyXG4gICAgICAgICAgaWYgKHdvcmRMaXN0W2pdICE9PSB3b3JkKSB7XHJcbiAgICAgICAgICAgIHdvcmRMaXN0VGVtcC5wdXNoKHdvcmRMaXN0W2pdKVxyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB3b3JkR3JvdXBMaXN0W2ldLnNldExpc3Qod29yZExpc3RUZW1wKVxyXG4gICAgICAgIHdvcmRHcm91cExpc3RbaV0uc2V0Q291bnQod29yZExpc3RUZW1wLmxlbmd0aClcclxuICAgICAgICB0aGlzLnNhdmVXb3JkR3JvdXBMaXN0KHdvcmRHcm91cExpc3QpXHJcbiAgICAgICAgcmV0dXJuXHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIOWwhuWNleivjeWIl+ihqOS/neWtmOWIsOe8k+WtmFxyXG4gICAqL1xyXG4gIHByaXZhdGUgc3RhdGljIHNhdmVXb3JkR3JvdXBMaXN0KHdvcmRHcm91cExpc3Q6QXJyYXk8V29yZEdyb3VwPik6dm9pZHtcclxuICAgIHd4LnNldFN0b3JhZ2VTeW5jKCd3b3JkR3JvdXBMaXN0Jyx3b3JkR3JvdXBMaXN0KVxyXG4gIH1cclxuXHJcbiAgLyoqKioqKioqKioqKiog57O757uf5Y+C5pWw5pON5L2cICoqKioqKioqKioqKioqL1xyXG4gIHB1YmxpYyBzdGF0aWMgc2V0UGFyYW1zKHBhcmFtczogUGFyYW1zKTogdm9pZCB7XHJcbiAgICB3eC5zZXRTdG9yYWdlU3luYyhcInBhcmFtc1wiLHBhcmFtcylcclxuICB9XHJcbiAgcHVibGljIHN0YXRpYyBnZXRQYXJhbXMoKTpQYXJhbXN7XHJcbiAgICBsZXQgcGFyYW1zT2JqZWN0OmFueSA9IHd4LmdldFN0b3JhZ2VTeW5jKFwicGFyYW1zXCIpXHJcbiAgICBsZXQgcGFyYW1zOlBhcmFtcyA9IG5ldyBQYXJhbXMoKVxyXG4gICAgaWYodHlwZW9mIHBhcmFtc09iamVjdCA9PT0gJ29iamVjdCcpe1xyXG4gICAgICBwYXJhbXMuc2V0U3BlZWQocGFyYW1zT2JqZWN0LnNwZWVkKVxyXG4gICAgICBwYXJhbXMuc2V0UmVwZWF0KHBhcmFtc09iamVjdC5yZXBlYXQpXHJcbiAgICAgIHBhcmFtcy5zZXRJbnRlcnZhbChwYXJhbXNPYmplY3QuaW50ZXJ2YWwpXHJcbiAgICAgIHBhcmFtcy5zZXRQYXVzZShwYXJhbXNPYmplY3QucGF1c2UpXHJcbiAgICAgIGlmIChwYXJhbXNPYmplY3QubW9kZSA9PT0gMCkge1xyXG4gICAgICAgIHBhcmFtcy5zZXRNb2RlKE1vZGUuUkFORE9NKVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChwYXJhbXNPYmplY3QubW9kZSA9PT0gMSkge1xyXG4gICAgICAgIHBhcmFtcy5zZXRNb2RlKE1vZGUuT1JERVIpXHJcbiAgICAgIH1cclxuICAgICAgaWYgKHBhcmFtc09iamVjdC5wcm9uID09PSAwKSB7XHJcbiAgICAgICAgcGFyYW1zLnNldFByb24oUHJvbnVuY2lhdGlvbi5CUklUSVNIKVxyXG4gICAgICB9XHJcbiAgICAgIGlmIChwYXJhbXNPYmplY3QucHJvbiA9PT0gMSkge1xyXG4gICAgICAgIHBhcmFtcy5zZXRQcm9uKFByb251bmNpYXRpb24uQU1FUklDQU4pXHJcbiAgICAgIH1cclxuICAgIH1cclxuICAgIHJldHVybiBwYXJhbXNcclxuICB9XHJcbn0iXX0=
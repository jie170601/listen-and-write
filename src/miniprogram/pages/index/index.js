"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const StorageUtil_1 = require("../../utils/StorageUtil");
const WordGroup_1 = require("../../beans/WordGroup");
const papaparse_1 = require("../../utils/papaparse");
var StateEnum;
(function (StateEnum) {
    StateEnum[StateEnum["WORD_UNFOLD_STATE"] = 0] = "WORD_UNFOLD_STATE";
    StateEnum[StateEnum["WORD_FOLD_STATE"] = 1] = "WORD_FOLD_STATE";
    StateEnum[StateEnum["ADD_GROUP_STATE"] = 2] = "ADD_GROUP_STATE";
    StateEnum[StateEnum["ADD_WORD_STATE"] = 3] = "ADD_WORD_STATE";
    StateEnum[StateEnum["BATCH_ADD_STATE"] = 4] = "BATCH_ADD_STATE";
})(StateEnum || (StateEnum = {}));
Page({
    data: {
        addGroupName: '',
        addWord: '',
        groupid: '',
        s: -1,
        wordGroupList: new Array(),
        State: StateEnum,
        curState: StateEnum.WORD_UNFOLD_STATE,
        preState: StateEnum.WORD_UNFOLD_STATE,
        selectData: [],
        textAreaCount: 0,
        textAreaValue: ''
    },
    onLoad() {
        this.flushPageData();
    },
    onShow() {
        this.flushPageData();
    },
    translateStateTo(nextState) {
        let preData = this.data.curState;
        this.setData({
            curState: nextState,
            preData: preData
        });
    },
    flushPageData() {
        let wordGroupList = StorageUtil_1.StorageUtil.getWordGroup();
        this.setData({
            wordGroupList: wordGroupList
        });
    },
    toAddGroup() {
        this.translateStateTo(StateEnum.ADD_GROUP_STATE);
    },
    saveAddGroup() {
        let wordGroup = new WordGroup_1.WordGroup();
        wordGroup.setCount(0);
        wordGroup.setName(this.data.addGroupName);
        StorageUtil_1.StorageUtil.addWordGroup(wordGroup);
        this.translateStateTo(StateEnum.WORD_UNFOLD_STATE);
        this.setData({
            addGroupName: ''
        });
        this.flushPageData();
    },
    cancelAddGroup() {
        this.translateStateTo(StateEnum.WORD_UNFOLD_STATE);
    },
    deleteGroup() {
    },
    saveDeleteGroup() {
        let that = this;
        wx.showModal({
            title: '提示',
            content: '确定删除吗？',
            success(res) {
                if (res.confirm) {
                    StorageUtil_1.StorageUtil.deleteWordGroup(new WordGroup_1.WordGroup());
                    that.translateStateTo(that.data.preState);
                    that.flushPageData();
                }
            }
        });
    },
    cancelDeleteGroup() {
        this.translateStateTo(this.data.preState);
    },
    addGroupNameChanged(e) {
        this.setData({
            addGroupName: e.detail.value
        });
    },
    selectChanged(e) {
        console.log(e.detail.value);
    },
    foldWordGroup(e) {
        let tapid = e.currentTarget.id;
        let groupid = this.data.groupid;
        if (groupid === tapid) {
            groupid = "";
            this.translateStateTo(StateEnum.WORD_UNFOLD_STATE);
        }
        else {
            groupid = tapid;
            this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        }
        this.setData({
            groupid: groupid
        });
    },
    toAddWord() {
        this.translateStateTo(StateEnum.ADD_WORD_STATE);
    },
    addWordChanged(e) {
        this.setData({
            addWord: e.detail.value,
            groupid: e.currentTarget.id
        });
    },
    saveAddWord() {
        let wordGroup = new WordGroup_1.WordGroup();
        let word = this.data.addWord;
        wordGroup.setId(this.data.groupid);
        StorageUtil_1.StorageUtil.addWord(wordGroup, word);
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            addWord: ''
        });
        this.flushPageData();
    },
    toAddWords() {
        this.translateStateTo(StateEnum.BATCH_ADD_STATE);
    },
    cancelAddWord() {
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            addWord: ''
        });
    },
    textAreaInput(e) {
        this.setData({
            textAreaValue: e.detail.value,
            textAreaCount: e.detail.value.length
        });
    },
    saveAddWords() {
        let words = this.data.textAreaValue;
        let wordList = papaparse_1.parse(words).data;
        let wordGroup = new WordGroup_1.WordGroup();
        wordGroup.setId(this.data.groupid);
        for (let i = 0; i < wordList.length; i++) {
            for (let j = 0; j < wordList[i].length; j++) {
                let word = wordList[i][j];
                StorageUtil_1.StorageUtil.addWord(wordGroup, word);
            }
        }
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            textAreaCount: 0,
            textAreaValue: ''
        });
        this.flushPageData();
    },
    cancelAddWords() {
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            textAreaCount: 0,
            textAreaValue: ''
        });
    },
    toDeleteWordGroup() {
        wx.navigateTo({
            url: '../delete/delete'
        });
    },
    toDeleteWord() {
        let that = this;
        wx.navigateTo({
            url: '../delete/delete?groupid=' + that.data.groupid
        });
    },
    listen() {
        let that = this;
        wx.navigateTo({
            url: '../listen/listen?groupid=' + that.data.groupid
        });
        return false;
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUtBLHlEQUFtRDtBQUluRCxxREFBaUQ7QUFFakQscURBQTJDO0FBZTNDLElBQUssU0FNSjtBQU5ELFdBQUssU0FBUztJQUNaLG1FQUFxQixDQUFBO0lBQ3JCLCtEQUFtQixDQUFBO0lBQ25CLCtEQUFtQixDQUFBO0lBQ25CLDZEQUFrQixDQUFBO0lBQ2xCLCtEQUFtQixDQUFBO0FBQ3JCLENBQUMsRUFOSSxTQUFTLEtBQVQsU0FBUyxRQU1iO0FBRUQsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osWUFBWSxFQUFDLEVBQUU7UUFDZixPQUFPLEVBQUMsRUFBRTtRQUNWLE9BQU8sRUFBQyxFQUFFO1FBQ1YsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNMLGFBQWEsRUFBQyxJQUFJLEtBQUssRUFBYTtRQUNwQyxLQUFLLEVBQUMsU0FBUztRQUNmLFFBQVEsRUFBRSxTQUFTLENBQUMsaUJBQWlCO1FBQ3JDLFFBQVEsRUFBQyxTQUFTLENBQUMsaUJBQWlCO1FBQ3BDLFVBQVUsRUFBQyxFQUFFO1FBQ2IsYUFBYSxFQUFDLENBQUM7UUFDZixhQUFhLEVBQUMsRUFBRTtLQUNqQjtJQUNELE1BQU07UUFDSixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDdEIsQ0FBQztJQUNELE1BQU07UUFDSixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDdEIsQ0FBQztJQU9ELGdCQUFnQixDQUFDLFNBQW9CO1FBQ25DLElBQUksT0FBTyxHQUFhLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFBO1FBQzFDLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixRQUFRLEVBQUUsU0FBUztZQUNuQixPQUFPLEVBQUMsT0FBTztTQUNoQixDQUFDLENBQUE7SUFDSixDQUFDO0lBSUQsYUFBYTtRQUNYLElBQUksYUFBYSxHQUFvQix5QkFBVyxDQUFDLFlB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QyxVQUFVLENBQUM7WUFDWixHQUFHLEVBQUUsMkJBQTJCLEdBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPO1NBQ25ELENBQUMsQ0FBQTtJQUNKLENBQUM7SUFDRCxNQUFNO1FBQ0osSUFBSSxJQUFJLEdBQU8sSUFBSSxDQUFBO1FBQ25CLEVBQUUsQ0FBQyxVQUFVLENBQUM7WUFDWixHQUFHLEVBQUUsMkJBQTJCLEdBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPO1NBQ25ELENBQUMsQ0FBQTtRQUNGLE9BQU8sS0FBSyxDQUFBO0lBQ2QsQ0FBQztDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vaW5kZXguanNcbi8v6I635Y+W5bqU55So5a6e5L6LXG4vLyBpbXBvcnQgeyBJTXlBcHAgfSBmcm9tICcuLi8uLi9hcHAnXG4vLyBpbXBvcnQgeyBXb3JkMk1wMyB9IGZyb20gJy4uLy4uL3V0aWxzL1dvcmQyTXAzJ1xuLy8gaW1wb3J0IHsgc2hvd0Vycm9yTXNnIH0gZnJvbSAnLi4vLi4vdXRpbHMvdXRpbCdcbmltcG9ydCB7U3RvcmFnZVV0aWx9IGZyb20gJy4uLy4uL3V0aWxzL1N0b3JhZ2VVdGlsJ1xuLy8gaW1wb3J0IHtXb3JkTGlzdH0gZnJvbSAnLi4vLi4vYmVhbi9Xb3JkTGlzdCdcbi8vIGltcG9ydCB7SW5kZXhMaXN0fSBmcm9tICcuLi8uLi9iZWFuL0luZGV4XG4vLyBpbXBvcnQge0F1ZGlvVXRpbH0gZnJvbSAnLi4vLi4vdXRpbHMvQXVkaW9VdGlsJ1xuaW1wb3J0IHsgV29yZEdyb3VwIH0gZnJvbSAnLi4vLi4vYmVhbnMvV29yZEdyb3VwJ1xuaW1wb3J0IHsgV29yZCB9IGZyb20gJy4uLy4uL2JlYW5zL1dvcmQnXG5pbXBvcnQge3BhcnNlfSBmcm9tICcuLi8uLi91dGlscy9wYXBhcGFyc2UnXG5cbi8vIGNvbnN0IGFwcCA9IGdldEFwcDxJTXlBcHA+KClcblxuLy8gY29uc3QgYXVkaW9VdGlsID0gbmV3IEF1ZGlvVXRpbCgpXG5cbi8qKlxuICog5Zyo6L+Z5Liq6aG16Z2i5Lit77yM5pyJ5b6I5aSa5aSN5p2C55qE5pON5L2cXG4gKiDnu4/luLjopoHmoLnmja7lvZPliY3miYDlpITnmoTnirbmgIHmnaXlhrPlrprmmL7npLrku4DkuYhcbiAqIOaIluiAheagueaNruW9k+WJjeeahOeKtuaAgeadpeWGs+WumuaMiemSrueahOWKn+iDveaYr+S7gOS5iFxuICog5omA5Lul5oOz5Yiw5LqG55So5pyJ6ZmQ54q25oCB5py6XG4gKiBcbiAqIOi/memHjOWFiOWumuS5ieS6huS4gOS4quaemuS4vlxuICog5p2l5L+d5a2Y6aG16Z2i55qE5omA5pyJ54q25oCBXG4gKi8gXG5lbnVtIFN0YXRlRW51bSB7XG4gIFdPUkRfVU5GT0xEX1NUQVRFID0gMCwvL+WNleivjeWIl+ihqOacquWxleW8gOeKtuaAgVxuICBXT1JEX0ZPTERfU1RBVEUgPSAxLC8v5Y2V6K+N5YiX6KGo5bGV5byA54q25oCBXG4gIEFERF9HUk9VUF9TVEFURSA9IDIsLy/mt7vliqDliIbnu4TnirbmgIFcbiAgQUREX1dPUkRfU1RBVEUgPSAzLC8v5re75Yqg5Y2V6K+N54q25oCBXG4gIEJBVENIX0FERF9TVEFURSA9IDQvL+aJuemHj+a3u+WKoOWNleivjeeKtuaAgVxufVxuXG5QYWdlKHtcbiAgZGF0YToge1xuICAgIGFkZEdyb3VwTmFtZTonJywvL+eUqOaIt+i+k+WFpeeahOa3u+WKoOWIhue7hOWQjeensFxuICAgIGFkZFdvcmQ6JycsXG4gICAgZ3JvdXBpZDonJyxcbiAgICBzOiAtMSxcbiAgICB3b3JkR3JvdXBMaXN0Om5ldyBBcnJheTxXb3JkR3JvdXA+KCksXG4gICAgU3RhdGU6U3RhdGVFbnVtLFxuICAgIGN1clN0YXRlOiBTdGF0ZUVudW0uV09SRF9VTkZPTERfU1RBVEUsXG4gICAgcHJlU3RhdGU6U3RhdGVFbnVtLldPUkRfVU5GT0xEX1NUQVRFLFxuICAgIHNlbGVjdERhdGE6W10sXG4gICAgdGV4dEFyZWFDb3VudDowLFxuICAgIHRleHRBcmVhVmFsdWU6JydcbiAgfSxcbiAgb25Mb2FkKCkge1xuICAgIHRoaXMuZmx1c2hQYWdlRGF0YSgpXG4gIH0sXG4gIG9uU2hvdygpe1xuICAgIHRoaXMuZmx1c2hQYWdlRGF0YSgpXG4gIH0sXG4gIC8qKlxuICAgKiDnirbmgIHovaznp7vlh73mlbBcbiAgICog5Y+v5Lul5bCG5b2T5YmN54q25oCB6L2s56e75YiwbmV4dFNhdGVcbiAgICog5b2T5YmN54q25oCB5L+d5a2Y5YiwcHJlU3RhdGVcbiAgICog5Lul5aSH5pyJ5Lqb5Zyw5pa55oGi5aSN54q25oCB6KaB55So5YiwXG4gICAqL1xuICB0cmFuc2xhdGVTdGF0ZVRvKG5leHRTdGF0ZTogU3RhdGVFbnVtKSB7XG4gICAgbGV0IHByZURhdGE6U3RhdGVFbnVtID0gdGhpcy5kYXRhLmN1clN0YXRlXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBjdXJTdGF0ZTogbmV4dFN0YXRlLFxuICAgICAgcHJlRGF0YTpwcmVEYXRhXG4gICAgfSlcbiAgfSxcbiAgLyoqXG4gICAqIOWIt+aWsOmhtemdouaVsOaNru+8jOavj+asoeaVsOaNruacieWPmOWMlumcgOimgeiwg+eUqOatpOaWueazleWIt+aWsOS4gOS4i+eVjOmdolxuICAgKi9cbiAgZmx1c2hQYWdlRGF0YSgpe1xuICAgIGxldCB3b3JkR3JvdXBMaXN0OkFycmF5PFdvcmRHcm91cD4gPSBTdG9yYWdlVXRpbC5nZXRXb3JkR3JvdXAoKVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgd29yZEdyb3VwTGlzdDp3b3JkR3JvdXBMaXN0XG4gICAgfSlcbiAgfSxcbiAgLyoqXG4gICAqIOa3u+WKoOWIhue7hOaMiemSrueCueWHu+S6i+S7tuWkhOeQhlxuICAgKiDngrnlh7vmt7vliqDliIbnu4TlkI5cbiAgICog54q25oCB6L2s56e75Yiw5re75Yqg5YiG57uE54q25oCBXG4gICAqL1xuICB0b0FkZEdyb3VwKCkge1xuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uQUREX0dST1VQX1NUQVRFKVxuICB9LFxuICAvKipcbiAgICog5L+d5a2Y5re75Yqg5YiG57uE5oyJ6ZKu54K55Ye75LqL5Lu2XG4gICAqIOeCueWHu+S/neWtmOWQjlxuICAgKiAxLuS/neWtmOWIhue7hOWIsOWIhue7hOWIl+ihqFxuICAgKiAyLuabtOaWsOmhtemdouaVsOaNrlxuICAgKiAzLuWwhueKtuaAgei9rOenu+WIsOWNleivjeWIl+ihqOacquWxleW8gOeKtuaAgVxuICAgKi9cbiAgc2F2ZUFkZEdyb3VwKCkge1xuICAgIGxldCB3b3JkR3JvdXA6V29yZEdyb3VwID0gbmV3IFdvcmRHcm91cCgpXG4gICAgd29yZEdyb3VwLnNldENvdW50KDApXG4gICAgd29yZEdyb3VwLnNldE5hbWUodGhpcy5kYXRhLmFkZEdyb3VwTmFtZSlcbiAgICBTdG9yYWdlVXRpbC5hZGRXb3JkR3JvdXAod29yZEdyb3VwKVxuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uV09SRF9VTkZPTERfU1RBVEUpXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBhZGRHcm91cE5hbWU6JydcbiAgICB9KVxuICAgIHRoaXMuZmx1c2hQYWdlRGF0YSgpXG4gIH0sXG4gIC8qKlxuICAgKiDlj5bmtojmt7vliqDliIbnu4TmjInpkq7ngrnlh7vkuovku7ZcbiAgICog54K55Ye75Y+W5raI5ZCOXG4gICAqIOeKtuaAgei9rOenu+WIsOWNleivjeWIl+ihqOacquWxleW8gOeKtuaAgVxuICAgKi9cbiAgY2FuY2VsQWRkR3JvdXAoKXtcbiAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLldPUkRfVU5GT0xEX1NUQVRFKVxuICB9LFxuICAvKipcbiAgICog57yW6L6R5oyJ6ZKu54K55Ye75LqL5Lu2XG4gICAqL1xuICBkZWxldGVHcm91cCgpe1xuICAgIC8vdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5ERUxFVEVfU1RBVEUpXG4gIH0sXG4gIC8qKlxuICAgKiDliKDpmaTpgInkuK3nmoTljZXor43liIbnu4TlkozljZXor41cbiAgICovXG4gIHNhdmVEZWxldGVHcm91cCgpe1xuICAgIGxldCB0aGF0ID0gdGhpc1xuICAgIHd4LnNob3dNb2RhbCh7XG4gICAgICB0aXRsZTogJ+aPkOekuicsXG4gICAgICBjb250ZW50OiAn56Gu5a6a5Yig6Zmk5ZCX77yfJyxcbiAgICAgIHN1Y2Nlc3MocmVzKSB7XG4gICAgICAgIGlmIChyZXMuY29uZmlybSkge1xuICAgICAgICAgIFN0b3JhZ2VVdGlsLmRlbGV0ZVdvcmRHcm91cChuZXcgV29yZEdyb3VwKCkpXG4gICAgICAgICAgdGhhdC50cmFuc2xhdGVTdGF0ZVRvKHRoYXQuZGF0YS5wcmVTdGF0ZSlcbiAgICAgICAgICB0aGF0LmZsdXNoUGFnZURhdGEoKVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSlcbiAgfSxcbiAgLyoqXG4gICAqIOWPlua2iOe8lui+kVxuICAgKiDov5nph4znirbmgIHot7PovaznmoTml7blgJnmnInkuKTnp43lj6/og71cbiAgICog5Y+v6IO96Lez6L2s5Yiw5Y2V6K+N5YiG57uE5bGV5byA55qE54q25oCBXG4gICAqIOS5n+WPr+iDvei3s+i9rOWIsOWNleivjeWIhue7hOacquWxleW8gOeahOeKtuaAgVxuICAgKiDlhbfkvZPnmoTopoHmoLnmja7liY3pnaLnmoTnirbmgIHmnaXliKTmlq1cbiAgICovXG4gIGNhbmNlbERlbGV0ZUdyb3VwKCl7XG4gICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKHRoaXMuZGF0YS5wcmVTdGF0ZSlcbiAgfSxcbiAgLy/mt7vliqDliIbnu4TovpPlhaXmoYbovpPlhaXkuovku7blpITnkIZcbiAgYWRkR3JvdXBOYW1lQ2hhbmdlZChlOmFueSl7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBhZGRHcm91cE5hbWU6ZS5kZXRhaWwudmFsdWVcbiAgICB9KVxuICB9LFxuICAvL+e8lui+keeKtuaAgeS4i+mAieaLqeaUueWPmOS6i+S7tuWkhOeQhlxuICBzZWxlY3RDaGFuZ2VkKGU6YW55KXtcbiAgICBjb25zb2xlLmxvZyhlLmRldGFpbC52YWx1ZSlcbiAgICAvLyB0aGlzLnNldERhdGEhKHtcbiAgICAvLyAgIHNlbGVjdERhdGE6ZS5kZXRhaWwudmFsdWVcbiAgICAvLyB9KVxuICB9LFxuICAvKipcbiAgICog5bGV5byA5omA54K55Ye755qE5Y2V6K+N5YiX6KGoXG4gICAqIOW5tuaUtui1t+WFtuWug+WNleivjeWIl+ihqFxuICAgKiDlpoLmnpzngrnlh7vnmoTljZXor43liJfooajmnKzouqvlsLHmmK/lsZXlvIDnmoRcbiAgICog6YKj5LmI5bCx5pS26LW35omA5pyJ55qE5Y2V6K+N5YiX6KGoXG4gICAqIOmhtemdoueahOeKtuaAgeS7juWxleW8gOaAgeWPmOaIkOacquWxleW8gOaAgVxuICAgKi9cbiAgZm9sZFdvcmRHcm91cChlOmFueSl7XG4gICAgbGV0IHRhcGlkOnN0cmluZyA9IGUuY3VycmVudFRhcmdldC5pZFxuICAgIGxldCBncm91cGlkOnN0cmluZyA9IHRoaXMuZGF0YS5ncm91cGlkXG4gICAgaWYgKGdyb3VwaWQgPT09IHRhcGlkKXtcbiAgICAgIGdyb3VwaWQgPSBcIlwiXG4gICAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLldPUkRfVU5GT0xEX1NUQVRFKVxuICAgIH0gZWxzZSB7XG4gICAgICBncm91cGlkID0gdGFwaWRcbiAgICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uV09SRF9GT0xEX1NUQVRFKVxuICAgIH1cbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGdyb3VwaWQ6Z3JvdXBpZFxuICAgIH0pXG4gIH0sXG4gIHRvQWRkV29yZCgpe1xuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uQUREX1dPUkRfU1RBVEUpXG4gIH0sXG4gIGFkZFdvcmRDaGFuZ2VkKGU6YW55KXtcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIGFkZFdvcmQ6ZS5kZXRhaWwudmFsdWUsXG4gICAgICBncm91cGlkOmUuY3VycmVudFRhcmdldC5pZFxuICAgIH0pXG4gIH0sXG4gIHNhdmVBZGRXb3JkKCl7XG4gICAgbGV0IHdvcmRHcm91cDpXb3JkR3JvdXAgPSBuZXcgV29yZEdyb3VwKClcbiAgICBsZXQgd29yZDpXb3JkID0gdGhpcy5kYXRhLmFkZFdvcmRcbiAgICB3b3JkR3JvdXAuc2V0SWQodGhpcy5kYXRhLmdyb3VwaWQpXG4gICAgU3RvcmFnZVV0aWwuYWRkV29yZCh3b3JkR3JvdXAsIHdvcmQpXG4gICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5XT1JEX0ZPTERfU1RBVEUpXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBhZGRXb3JkOiAnJ1xuICAgIH0pXG4gICAgdGhpcy5mbHVzaFBhZ2VEYXRhKClcbiAgfSxcbiAgLyoqXG4gICAqIOaJuemHj+a3u+WKoOWNleivjeaMiemSrueCueWHu+S6i+S7tuWkhOeQhlxuICAgKi9cbiAgdG9BZGRXb3Jkcygpe1xuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uQkFUQ0hfQUREX1NUQVRFKVxuICAgIC8vY29uc29sZS5sb2cocGFyc2UoXCJhLGIsYyxkZFwiKSlcbiAgfSxcbiAgLyoqXG4gICAqIOW9k+WPlua2iOa3u+WKoOWNleivjeaMiemSrueCueWHu+eahOaXtuWAmVxuICAgKiDpnIDopoHlsIbnirbmgIHmlLnkuLrljZXor43liIbnu4TlsZXlvIDnirbmgIFcbiAgICog5bm25LiU5bCG6L6T5YWl55qE5Y2V6K+N572u5Li656m6XG4gICAqL1xuICBjYW5jZWxBZGRXb3JkKCl7XG4gICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5XT1JEX0ZPTERfU1RBVEUpXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBhZGRXb3JkOiAnJ1xuICAgIH0pXG4gIH0sXG4gIHRleHRBcmVhSW5wdXQoZTphbnkpe1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgdGV4dEFyZWFWYWx1ZTplLmRldGFpbC52YWx1ZSxcbiAgICAgIHRleHRBcmVhQ291bnQ6ZS5kZXRhaWwudmFsdWUubGVuZ3RoXG4gICAgfSlcbiAgfSxcbiAgLyoqXG4gICAqIOaJuemHj+a3u+WKoOWNleivje+8jOS/neWtmOaMiemSrueCueWHu+S6i+S7tuWkhOeQhlxuICAgKi9cbiAgc2F2ZUFkZFdvcmRzKCl7XG4gICAgbGV0IHdvcmRzOnN0cmluZyA9IHRoaXMuZGF0YS50ZXh0QXJlYVZhbHVlXG4gICAgbGV0IHdvcmRMaXN0OkFycmF5PHN0cmluZz4gPSBwYXJzZSh3b3JkcykuZGF0YVxuICAgIGxldCB3b3JkR3JvdXA6V29yZEdyb3VwID0gbmV3IFdvcmRHcm91cCgpXG4gICAgd29yZEdyb3VwLnNldElkKHRoaXMuZGF0YS5ncm91cGlkKVxuICAgIGZvcihsZXQgaT0wO2k8d29yZExpc3QubGVuZ3RoO2krKyl7XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHdvcmRMaXN0W2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICAgIGxldCB3b3JkOiBXb3JkID0gd29yZExpc3RbaV1bal1cbiAgICAgICAgU3RvcmFnZVV0aWwuYWRkV29yZCh3b3JkR3JvdXAsIHdvcmQpXG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uV09SRF9GT0xEX1NUQVRFKVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgdGV4dEFyZWFDb3VudDowLFxuICAgICAgdGV4dEFyZWFWYWx1ZTonJ1xuICAgIH0pXG4gICAgdGhpcy5mbHVzaFBhZ2VEYXRhKClcbiAgfSwgXG4gIC8qKiAgXG4gICAqIOaJuemHj+a3u+WKoOWNleivje+8jOWPlua2iOaMiemSrueCueWHu+S6i+S7tuWkhOeQhlxuICAgKi9cbiAgY2FuY2VsQWRkV29yZHMoKXtcbiAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLldPUkRfRk9MRF9TVEFURSlcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHRleHRBcmVhQ291bnQ6MCxcbiAgICAgIHRleHRBcmVhVmFsdWU6JydcbiAgICB9KVxuICB9LFxuICAvKipcbiAgICog5Y675Yig6Zmk5Y2V6K+N5YiG57uE6aG16Z2iXG4gICAqL1xuICB0b0RlbGV0ZVdvcmRHcm91cCgpe1xuICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgdXJsOicuLi9kZWxldGUvZGVsZXRlJ1xuICAgIH0pXG4gIH0sXG4gIC8qKlxuICAgKiDljrvliKDpmaTljZXor43nlYzpnaJcbiAgICovXG4gIHRvRGVsZXRlV29yZCgpIHtcbiAgICBsZXQgdGhhdDphbnkgPSB0aGlzXG4gICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICB1cmw6ICcuLi9kZWxldGUvZGVsZXRlP2dyb3VwaWQ9Jyt0aGF0LmRhdGEuZ3JvdXBpZFxuICAgIH0pXG4gIH0sXG4gIGxpc3Rlbigpe1xuICAgIGxldCB0aGF0OmFueSA9IHRoaXNcbiAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgIHVybDogJy4uL2xpc3Rlbi9saXN0ZW4/Z3JvdXBpZD0nK3RoYXQuZGF0YS5ncm91cGlkXG4gICAgfSlcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxufSlcblxuIl19
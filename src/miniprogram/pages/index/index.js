"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const StorageUtil_1 = require("../../utils/StorageUtil");
const WordGroup_1 = require("../../beans/WordGroup");
const papaparse_1 = require("../../utils/papaparse");
var StateEnum;
(function (StateEnum) {
    StateEnum[StateEnum["WORD_UNFOLD_STATE"] = 0] = "WORD_UNFOLD_STATE";
    StateEnum[StateEnum["WORD_FOLD_STATE"] = 1] = "WORD_FOLD_STATE";
    StateEnum[StateEnum["ADD_GROUP_STATE"] = 2] = "ADD_GROUP_STATE";
    StateEnum[StateEnum["ADD_WORD_STATE"] = 3] = "ADD_WORD_STATE";
    StateEnum[StateEnum["BATCH_ADD_STATE"] = 4] = "BATCH_ADD_STATE";
})(StateEnum || (StateEnum = {}));
Page({
    data: {
        addGroupName: '',
        addWord: '',
        groupid: '',
        s: -1,
        wordGroupList: new Array(),
        State: StateEnum,
        curState: StateEnum.WORD_UNFOLD_STATE,
        preState: StateEnum.WORD_UNFOLD_STATE,
        selectData: [],
        textAreaCount: 0,
        textAreaValue: ''
    },
    onLoad() {
        this.flushPageData();
    },
    onShow() {
        this.flushPageData();
    },
    translateStateTo(nextState) {
        let preData = this.data.curState;
        this.setData({
            curState: nextState,
            preData: preData
        });
    },
    flushPageData() {
        let wordGroupList = StorageUtil_1.StorageUtil.getWordGroup();
        this.setData({
            wordGroupList: wordGroupList
        });
    },
    toAddGroup() {
        this.translateStateTo(StateEnum.ADD_GROUP_STATE);
    },
    saveAddGroup() {
        let wordGroup = new WordGroup_1.WordGroup();
        wordGroup.setCount(0);
        wordGroup.setName(this.data.addGroupName);
        StorageUtil_1.StorageUtil.addWordGroup(wordGroup);
        this.translateStateTo(StateEnum.WORD_UNFOLD_STATE);
        this.setData({
            addGroupName: ''
        });
        this.flushPageData();
    },
    cancelAddGroup() {
        this.translateStateTo(StateEnum.WORD_UNFOLD_STATE);
    },
    deleteGroup() {
    },
    saveDeleteGroup() {
        let that = this;
        wx.showModal({
            title: '提示',
            content: '确定删除吗？',
            success(res) {
                if (res.confirm) {
                    StorageUtil_1.StorageUtil.deleteWordGroup(new WordGroup_1.WordGroup());
                    that.translateStateTo(that.data.preState);
                    that.flushPageData();
                }
            }
        });
    },
    cancelDeleteGroup() {
        this.translateStateTo(this.data.preState);
    },
    addGroupNameChanged(e) {
        this.setData({
            addGroupName: e.detail.value
        });
    },
    selectChanged(e) {
        console.log(e.detail.value);
    },
    foldWordGroup(e) {
        let tapid = e.currentTarget.id;
        let groupid = this.data.groupid;
        if (groupid === tapid) {
            groupid = "";
            this.translateStateTo(StateEnum.WORD_UNFOLD_STATE);
        }
        else {
            groupid = tapid;
            this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        }
        this.setData({
            groupid: groupid
        });
    },
    toAddWord() {
        this.translateStateTo(StateEnum.ADD_WORD_STATE);
    },
    addWordChanged(e) {
        this.setData({
            addWord: e.detail.value,
            groupid: e.currentTarget.id
        });
    },
    saveAddWord() {
        let wordGroup = new WordGroup_1.WordGroup();
        let word = this.data.addWord;
        wordGroup.setId(this.data.groupid);
        StorageUtil_1.StorageUtil.addWord(wordGroup, word);
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            addWord: ''
        });
        this.flushPageData();
    },
    toAddWords() {
        this.translateStateTo(StateEnum.BATCH_ADD_STATE);
    },
    cancelAddWord() {
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            addWord: ''
        });
    },
    textAreaInput(e) {
        this.setData({
            textAreaValue: e.detail.value,
            textAreaCount: e.detail.value.length
        });
    },
    saveAddWords() {
        let words = this.data.textAreaValue;
        let wordList = papaparse_1.parse(words).data;
        let wordGroup = new WordGroup_1.WordGroup();
        wordGroup.setId(this.data.groupid);
        for (let i = 0; i < wordList.length; i++) {
            for (let j = 0; j < wordList[i].length; j++) {
                let word = wordList[i][j];
                StorageUtil_1.StorageUtil.addWord(wordGroup, word);
            }
        }
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            textAreaCount: 0,
            textAreaValue: ''
        });
        this.flushPageData();
    },
    cancelAddWords() {
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            textAreaCount: 0,
            textAreaValue: ''
        });
    },
    toDeleteWordGroup() {
        wx.navigateTo({
            url: '../delete/delete'
        });
    },
    toDeleteWord() {
        let that = this;
        wx.navigateTo({
            url: '../delete/delete?groupid=' + that.data.groupid
        });
    },
    listen() {
        let that = this;
        wx.navigateTo({
            url: '../listen/listen?groupid=' + that.data.groupid
        });
        return false;
    },
    mean(e) {
        let word = e.currentTarget.id;
        let groupid = this.data.groupid;
        wx.navigateTo({
            url: '../mean/mean?groupid=' + groupid + '&word=' + word
        });
    },
    onShareAppMessage: function () {
        return {
            title: '每一次听写，为了离梦想更近一步',
            path: '/pages/index/index',
            imageUrl: "http://img1.ph.126.net/gtigWEVlA6XbXE9aFrB0ew==/2098114476501923011.jpg"
        };
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUNBLHlEQUFtRDtBQUNuRCxxREFBaUQ7QUFFakQscURBQTJDO0FBVzNDLElBQUssU0FNSjtBQU5ELFdBQUssU0FBUztJQUNaLG1FQUFxQixDQUFBO0lBQ3JCLCtEQUFtQixDQUFBO0lBQ25CLCtEQUFtQixDQUFBO0lBQ25CLDZEQUFrQixDQUFBO0lBQ2xCLCtEQUFtQixDQUFBO0FBQ3JCLENBQUMsRUFOSSxTQUFTLEtBQVQsU0FBUyxRQU1iO0FBRUQsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osWUFBWSxFQUFDLEVBQUU7UUFDZixPQUFPLEVBQUMsRUFBRTtRQUNWLE9BQU8sRUFBQyxFQUFFO1FBQ1YsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNMLGFBQWEsRUFBQyxJQUFJLEtBQUssRUFBYTtRQUNwQyxLQUFLLEVBQUMsU0FBUztRQUNmLFFBQVEsRUFBRSxTQUFTLENBQUMsaUJBQWlCO1FBQ3JDLFFBQVEsRUFBQyxTQUFTLENBQUMsaUJBQWlCO1FBQ3BDLFVBQVUsRUFBQyxFQUFFO1FBQ2IsYUFBYSxFQUFDLENBQUM7UUFDZixhQUFhLEVBQUMsRUFBRTtLQUNqQjtJQUNELE1BQU07UUFDSixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDdEIsQ0FBQztJQUNELE1BQU07UUFDSixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDdEIsQ0FBQztJQU9ELGdCQUFnQixDQUFDLFNBQW9CO1FBQ25DLElBQUksT0FBTyxHQUFhLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFBO1FBQzFDLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixRQUFRLEVBQUUsU0FBUztZQUNuQixPQUFPLEVBQUMsT0FBTztTQUNoQixDQUFDLENBQUE7SUFDSixDQUFDO0lBSUQsYUFBYTtRQUNYLElBQUksYUFBYSxHQUFvQix5QkFBVyxDQUFDLFlB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QyxVQUFVLENBQUM7WUFDWixHQUFHLEVBQUUsMkJBQTJCLEdBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPO1NBQ25ELENBQUMsQ0FBQTtJQUNKLENBQUM7SUFDRCxNQUFNO1FBQ0osSUFBSSxJQUFJLEdBQU8sSUFBSSxDQUFBO1FBQ25CLEVBQUUsQ0FBQyxVQUFVLENBQUM7WUFDWixHQUFHLEVBQUUsMkJBQTJCLEdBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPO1NBQ25ELENBQUMsQ0FBQTtRQUNGLE9BQU8sS0FBSyxDQUFBO0lBQ2QsQ0FBQztJQUNELElBQUksQ0FBQyxDQUFLO1FBQ1IsSUFBSSxJQUFJLEdBQVEsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxFQUFFLENBQUE7UUFDbEMsSUFBSSxPQUFPLEdBQVUsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUE7UUFDdEMsRUFBRSxDQUFDLFVBQVUsQ0FBQztZQUNaLEdBQUcsRUFBQyx1QkFBdUIsR0FBQyxPQUFPLEdBQUMsUUFBUSxHQUFDLElBQUk7U0FDbEQsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQUlELGlCQUFpQixFQUFFO1FBQ2pCLE9BQU87WUFDTCxLQUFLLEVBQUUsaUJBQWlCO1lBQ3hCLElBQUksRUFBRSxvQkFBb0I7WUFDMUIsUUFBUSxFQUFFLHlFQUF5RTtTQUNwRixDQUFBO0lBQ0gsQ0FBQztDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8v6I635Y+W5bqU55So5a6e5L6LXG5pbXBvcnQge1N0b3JhZ2VVdGlsfSBmcm9tICcuLi8uLi91dGlscy9TdG9yYWdlVXRpbCdcbmltcG9ydCB7IFdvcmRHcm91cCB9IGZyb20gJy4uLy4uL2JlYW5zL1dvcmRHcm91cCdcbmltcG9ydCB7IFdvcmQgfSBmcm9tICcuLi8uLi9iZWFucy9Xb3JkJ1xuaW1wb3J0IHtwYXJzZX0gZnJvbSAnLi4vLi4vdXRpbHMvcGFwYXBhcnNlJ1xuXG4vKipcbiAqIOWcqOi/meS4qumhtemdouS4re+8jOacieW+iOWkmuWkjeadgueahOaTjeS9nFxuICog57uP5bi46KaB5qC55o2u5b2T5YmN5omA5aSE55qE54q25oCB5p2l5Yaz5a6a5pi+56S65LuA5LmIXG4gKiDmiJbogIXmoLnmja7lvZPliY3nmoTnirbmgIHmnaXlhrPlrprmjInpkq7nmoTlip/og73mmK/ku4DkuYhcbiAqIOaJgOS7peaDs+WIsOS6hueUqOaciemZkOeKtuaAgeaculxuICogXG4gKiDov5nph4zlhYjlrprkuYnkuobkuIDkuKrmnprkuL5cbiAqIOadpeS/neWtmOmhtemdoueahOaJgOacieeKtuaAgVxuICovIFxuZW51bSBTdGF0ZUVudW0ge1xuICBXT1JEX1VORk9MRF9TVEFURSA9IDAsLy/ljZXor43liJfooajmnKrlsZXlvIDnirbmgIFcbiAgV09SRF9GT0xEX1NUQVRFID0gMSwvL+WNleivjeWIl+ihqOWxleW8gOeKtuaAgVxuICBBRERfR1JPVVBfU1RBVEUgPSAyLC8v5re75Yqg5YiG57uE54q25oCBXG4gIEFERF9XT1JEX1NUQVRFID0gMywvL+a3u+WKoOWNleivjeeKtuaAgVxuICBCQVRDSF9BRERfU1RBVEUgPSA0Ly/mibnph4/mt7vliqDljZXor43nirbmgIFcbn1cblxuUGFnZSh7XG4gIGRhdGE6IHtcbiAgICBhZGRHcm91cE5hbWU6JycsLy/nlKjmiLfovpPlhaXnmoTmt7vliqDliIbnu4TlkI3np7BcbiAgICBhZGRXb3JkOicnLFxuICAgIGdyb3VwaWQ6JycsXG4gICAgczogLTEsXG4gICAgd29yZEdyb3VwTGlzdDpuZXcgQXJyYXk8V29yZEdyb3VwPigpLFxuICAgIFN0YXRlOlN0YXRlRW51bSxcbiAgICBjdXJTdGF0ZTogU3RhdGVFbnVtLldPUkRfVU5GT0xEX1NUQVRFLFxuICAgIHByZVN0YXRlOlN0YXRlRW51bS5XT1JEX1VORk9MRF9TVEFURSxcbiAgICBzZWxlY3REYXRhOltdLFxuICAgIHRleHRBcmVhQ291bnQ6MCxcbiAgICB0ZXh0QXJlYVZhbHVlOicnXG4gIH0sXG4gIG9uTG9hZCgpIHtcbiAgICB0aGlzLmZsdXNoUGFnZURhdGEoKVxuICB9LFxuICBvblNob3coKXtcbiAgICB0aGlzLmZsdXNoUGFnZURhdGEoKVxuICB9LFxuICAvKipcbiAgICog54q25oCB6L2s56e75Ye95pWwXG4gICAqIOWPr+S7peWwhuW9k+WJjeeKtuaAgei9rOenu+WIsG5leHRTYXRlXG4gICAqIOW9k+WJjeeKtuaAgeS/neWtmOWIsHByZVN0YXRlXG4gICAqIOS7peWkh+acieS6m+WcsOaWueaBouWkjeeKtuaAgeimgeeUqOWIsFxuICAgKi9cbiAgdHJhbnNsYXRlU3RhdGVUbyhuZXh0U3RhdGU6IFN0YXRlRW51bSkge1xuICAgIGxldCBwcmVEYXRhOlN0YXRlRW51bSA9IHRoaXMuZGF0YS5jdXJTdGF0ZVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgY3VyU3RhdGU6IG5leHRTdGF0ZSxcbiAgICAgIHByZURhdGE6cHJlRGF0YVxuICAgIH0pXG4gIH0sXG4gIC8qKlxuICAgKiDliLfmlrDpobXpnaLmlbDmja7vvIzmr4/mrKHmlbDmja7mnInlj5jljJbpnIDopoHosIPnlKjmraTmlrnms5XliLfmlrDkuIDkuIvnlYzpnaJcbiAgICovXG4gIGZsdXNoUGFnZURhdGEoKXtcbiAgICBsZXQgd29yZEdyb3VwTGlzdDpBcnJheTxXb3JkR3JvdXA+ID0gU3RvcmFnZVV0aWwuZ2V0V29yZEdyb3VwKClcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHdvcmRHcm91cExpc3Q6d29yZEdyb3VwTGlzdFxuICAgIH0pXG4gIH0sXG4gIC8qKlxuICAgKiDmt7vliqDliIbnu4TmjInpkq7ngrnlh7vkuovku7blpITnkIZcbiAgICog54K55Ye75re75Yqg5YiG57uE5ZCOXG4gICAqIOeKtuaAgei9rOenu+WIsOa3u+WKoOWIhue7hOeKtuaAgVxuICAgKi9cbiAgdG9BZGRHcm91cCgpIHtcbiAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLkFERF9HUk9VUF9TVEFURSlcbiAgfSxcbiAgLyoqXG4gICAqIOS/neWtmOa3u+WKoOWIhue7hOaMiemSrueCueWHu+S6i+S7tlxuICAgKiDngrnlh7vkv53lrZjlkI5cbiAgICogMS7kv53lrZjliIbnu4TliLDliIbnu4TliJfooahcbiAgICogMi7mm7TmlrDpobXpnaLmlbDmja5cbiAgICogMy7lsIbnirbmgIHovaznp7vliLDljZXor43liJfooajmnKrlsZXlvIDnirbmgIFcbiAgICovXG4gIHNhdmVBZGRHcm91cCgpIHtcbiAgICBsZXQgd29yZEdyb3VwOldvcmRHcm91cCA9IG5ldyBXb3JkR3JvdXAoKVxuICAgIHdvcmRHcm91cC5zZXRDb3VudCgwKVxuICAgIHdvcmRHcm91cC5zZXROYW1lKHRoaXMuZGF0YS5hZGRHcm91cE5hbWUpXG4gICAgU3RvcmFnZVV0aWwuYWRkV29yZEdyb3VwKHdvcmRHcm91cClcbiAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLldPUkRfVU5GT0xEX1NUQVRFKVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgYWRkR3JvdXBOYW1lOicnXG4gICAgfSlcbiAgICB0aGlzLmZsdXNoUGFnZURhdGEoKVxuICB9LFxuICAvKipcbiAgICog5Y+W5raI5re75Yqg5YiG57uE5oyJ6ZKu54K55Ye75LqL5Lu2XG4gICAqIOeCueWHu+WPlua2iOWQjlxuICAgKiDnirbmgIHovaznp7vliLDljZXor43liJfooajmnKrlsZXlvIDnirbmgIFcbiAgICovXG4gIGNhbmNlbEFkZEdyb3VwKCl7XG4gICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5XT1JEX1VORk9MRF9TVEFURSlcbiAgfSxcbiAgLyoqXG4gICAqIOe8lui+keaMiemSrueCueWHu+S6i+S7tlxuICAgKi9cbiAgZGVsZXRlR3JvdXAoKXtcbiAgICAvL3RoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uREVMRVRFX1NUQVRFKVxuICB9LFxuICAvKipcbiAgICog5Yig6Zmk6YCJ5Lit55qE5Y2V6K+N5YiG57uE5ZKM5Y2V6K+NXG4gICAqL1xuICBzYXZlRGVsZXRlR3JvdXAoKXtcbiAgICBsZXQgdGhhdCA9IHRoaXNcbiAgICB3eC5zaG93TW9kYWwoe1xuICAgICAgdGl0bGU6ICfmj5DnpLonLFxuICAgICAgY29udGVudDogJ+ehruWumuWIoOmZpOWQl++8nycsXG4gICAgICBzdWNjZXNzKHJlcykge1xuICAgICAgICBpZiAocmVzLmNvbmZpcm0pIHtcbiAgICAgICAgICBTdG9yYWdlVXRpbC5kZWxldGVXb3JkR3JvdXAobmV3IFdvcmRHcm91cCgpKVxuICAgICAgICAgIHRoYXQudHJhbnNsYXRlU3RhdGVUbyh0aGF0LmRhdGEucHJlU3RhdGUpXG4gICAgICAgICAgdGhhdC5mbHVzaFBhZ2VEYXRhKClcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG4gIH0sXG4gIC8qKlxuICAgKiDlj5bmtojnvJbovpFcbiAgICog6L+Z6YeM54q25oCB6Lez6L2s55qE5pe25YCZ5pyJ5Lik56eN5Y+v6IO9XG4gICAqIOWPr+iDvei3s+i9rOWIsOWNleivjeWIhue7hOWxleW8gOeahOeKtuaAgVxuICAgKiDkuZ/lj6/og73ot7PovazliLDljZXor43liIbnu4TmnKrlsZXlvIDnmoTnirbmgIFcbiAgICog5YW35L2T55qE6KaB5qC55o2u5YmN6Z2i55qE54q25oCB5p2l5Yik5patXG4gICAqL1xuICBjYW5jZWxEZWxldGVHcm91cCgpe1xuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyh0aGlzLmRhdGEucHJlU3RhdGUpXG4gIH0sXG4gIC8v5re75Yqg5YiG57uE6L6T5YWl5qGG6L6T5YWl5LqL5Lu25aSE55CGXG4gIGFkZEdyb3VwTmFtZUNoYW5nZWQoZTphbnkpe1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgYWRkR3JvdXBOYW1lOmUuZGV0YWlsLnZhbHVlXG4gICAgfSlcbiAgfSxcbiAgLy/nvJbovpHnirbmgIHkuIvpgInmi6nmlLnlj5jkuovku7blpITnkIZcbiAgc2VsZWN0Q2hhbmdlZChlOmFueSl7XG4gICAgY29uc29sZS5sb2coZS5kZXRhaWwudmFsdWUpXG4gICAgLy8gdGhpcy5zZXREYXRhISh7XG4gICAgLy8gICBzZWxlY3REYXRhOmUuZGV0YWlsLnZhbHVlXG4gICAgLy8gfSlcbiAgfSxcbiAgLyoqXG4gICAqIOWxleW8gOaJgOeCueWHu+eahOWNleivjeWIl+ihqFxuICAgKiDlubbmlLbotbflhbblroPljZXor43liJfooahcbiAgICog5aaC5p6c54K55Ye755qE5Y2V6K+N5YiX6KGo5pys6Lqr5bCx5piv5bGV5byA55qEXG4gICAqIOmCo+S5iOWwseaUtui1t+aJgOacieeahOWNleivjeWIl+ihqFxuICAgKiDpobXpnaLnmoTnirbmgIHku47lsZXlvIDmgIHlj5jmiJDmnKrlsZXlvIDmgIFcbiAgICovXG4gIGZvbGRXb3JkR3JvdXAoZTphbnkpe1xuICAgIGxldCB0YXBpZDpzdHJpbmcgPSBlLmN1cnJlbnRUYXJnZXQuaWRcbiAgICBsZXQgZ3JvdXBpZDpzdHJpbmcgPSB0aGlzLmRhdGEuZ3JvdXBpZFxuICAgIGlmIChncm91cGlkID09PSB0YXBpZCl7XG4gICAgICBncm91cGlkID0gXCJcIlxuICAgICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5XT1JEX1VORk9MRF9TVEFURSlcbiAgICB9IGVsc2Uge1xuICAgICAgZ3JvdXBpZCA9IHRhcGlkXG4gICAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLldPUkRfRk9MRF9TVEFURSlcbiAgICB9XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBncm91cGlkOmdyb3VwaWRcbiAgICB9KVxuICB9LFxuICB0b0FkZFdvcmQoKXtcbiAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLkFERF9XT1JEX1NUQVRFKVxuICB9LFxuICBhZGRXb3JkQ2hhbmdlZChlOmFueSl7XG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBhZGRXb3JkOmUuZGV0YWlsLnZhbHVlLFxuICAgICAgZ3JvdXBpZDplLmN1cnJlbnRUYXJnZXQuaWRcbiAgICB9KVxuICB9LFxuICBzYXZlQWRkV29yZCgpe1xuICAgIGxldCB3b3JkR3JvdXA6V29yZEdyb3VwID0gbmV3IFdvcmRHcm91cCgpXG4gICAgbGV0IHdvcmQ6V29yZCA9IHRoaXMuZGF0YS5hZGRXb3JkXG4gICAgd29yZEdyb3VwLnNldElkKHRoaXMuZGF0YS5ncm91cGlkKVxuICAgIFN0b3JhZ2VVdGlsLmFkZFdvcmQod29yZEdyb3VwLCB3b3JkKVxuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uV09SRF9GT0xEX1NUQVRFKVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgYWRkV29yZDogJydcbiAgICB9KVxuICAgIHRoaXMuZmx1c2hQYWdlRGF0YSgpXG4gIH0sXG4gIC8qKlxuICAgKiDmibnph4/mt7vliqDljZXor43mjInpkq7ngrnlh7vkuovku7blpITnkIZcbiAgICovXG4gIHRvQWRkV29yZHMoKXtcbiAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLkJBVENIX0FERF9TVEFURSlcbiAgfSxcbiAgLyoqXG4gICAqIOW9k+WPlua2iOa3u+WKoOWNleivjeaMiemSrueCueWHu+eahOaXtuWAmVxuICAgKiDpnIDopoHlsIbnirbmgIHmlLnkuLrljZXor43liIbnu4TlsZXlvIDnirbmgIFcbiAgICog5bm25LiU5bCG6L6T5YWl55qE5Y2V6K+N572u5Li656m6XG4gICAqL1xuICBjYW5jZWxBZGRXb3JkKCl7XG4gICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5XT1JEX0ZPTERfU1RBVEUpXG4gICAgdGhpcy5zZXREYXRhISh7XG4gICAgICBhZGRXb3JkOiAnJ1xuICAgIH0pXG4gIH0sXG4gIHRleHRBcmVhSW5wdXQoZTphbnkpe1xuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgdGV4dEFyZWFWYWx1ZTplLmRldGFpbC52YWx1ZSxcbiAgICAgIHRleHRBcmVhQ291bnQ6ZS5kZXRhaWwudmFsdWUubGVuZ3RoXG4gICAgfSlcbiAgfSxcbiAgLyoqXG4gICAqIOaJuemHj+a3u+WKoOWNleivje+8jOS/neWtmOaMiemSrueCueWHu+S6i+S7tuWkhOeQhlxuICAgKi9cbiAgc2F2ZUFkZFdvcmRzKCl7XG4gICAgbGV0IHdvcmRzOnN0cmluZyA9IHRoaXMuZGF0YS50ZXh0QXJlYVZhbHVlXG4gICAgbGV0IHdvcmRMaXN0OkFycmF5PHN0cmluZz4gPSBwYXJzZSh3b3JkcykuZGF0YVxuICAgIGxldCB3b3JkR3JvdXA6V29yZEdyb3VwID0gbmV3IFdvcmRHcm91cCgpXG4gICAgd29yZEdyb3VwLnNldElkKHRoaXMuZGF0YS5ncm91cGlkKVxuICAgIGZvcihsZXQgaT0wO2k8d29yZExpc3QubGVuZ3RoO2krKyl7XG4gICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHdvcmRMaXN0W2ldLmxlbmd0aDsgaisrKSB7XG4gICAgICAgIGxldCB3b3JkOiBXb3JkID0gd29yZExpc3RbaV1bal1cbiAgICAgICAgU3RvcmFnZVV0aWwuYWRkV29yZCh3b3JkR3JvdXAsIHdvcmQpXG4gICAgICB9XG4gICAgfVxuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uV09SRF9GT0xEX1NUQVRFKVxuICAgIHRoaXMuc2V0RGF0YSEoe1xuICAgICAgdGV4dEFyZWFDb3VudDowLFxuICAgICAgdGV4dEFyZWFWYWx1ZTonJ1xuICAgIH0pXG4gICAgdGhpcy5mbHVzaFBhZ2VEYXRhKClcbiAgfSwgXG4gIC8qKiAgXG4gICAqIOaJuemHj+a3u+WKoOWNleivje+8jOWPlua2iOaMiemSrueCueWHu+S6i+S7tuWkhOeQhlxuICAgKi9cbiAgY2FuY2VsQWRkV29yZHMoKXtcbiAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLldPUkRfRk9MRF9TVEFURSlcbiAgICB0aGlzLnNldERhdGEhKHtcbiAgICAgIHRleHRBcmVhQ291bnQ6MCxcbiAgICAgIHRleHRBcmVhVmFsdWU6JydcbiAgICB9KVxuICB9LFxuICAvKipcbiAgICog5Y675Yig6Zmk5Y2V6K+N5YiG57uE6aG16Z2iXG4gICAqL1xuICB0b0RlbGV0ZVdvcmRHcm91cCgpe1xuICAgIHd4Lm5hdmlnYXRlVG8oe1xuICAgICAgdXJsOicuLi9kZWxldGUvZGVsZXRlJ1xuICAgIH0pXG4gIH0sXG4gIC8qKlxuICAgKiDljrvliKDpmaTljZXor43nlYzpnaJcbiAgICovXG4gIHRvRGVsZXRlV29yZCgpIHtcbiAgICBsZXQgdGhhdDphbnkgPSB0aGlzXG4gICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICB1cmw6ICcuLi9kZWxldGUvZGVsZXRlP2dyb3VwaWQ9Jyt0aGF0LmRhdGEuZ3JvdXBpZFxuICAgIH0pXG4gIH0sXG4gIGxpc3Rlbigpe1xuICAgIGxldCB0aGF0OmFueSA9IHRoaXNcbiAgICB3eC5uYXZpZ2F0ZVRvKHtcbiAgICAgIHVybDogJy4uL2xpc3Rlbi9saXN0ZW4/Z3JvdXBpZD0nK3RoYXQuZGF0YS5ncm91cGlkXG4gICAgfSlcbiAgICByZXR1cm4gZmFsc2VcbiAgfSxcbiAgbWVhbihlOmFueSl7XG4gICAgbGV0IHdvcmQ6V29yZCA9IGUuY3VycmVudFRhcmdldC5pZFxuICAgIGxldCBncm91cGlkOnN0cmluZyA9IHRoaXMuZGF0YS5ncm91cGlkXG4gICAgd3gubmF2aWdhdGVUbyh7XG4gICAgICB1cmw6Jy4uL21lYW4vbWVhbj9ncm91cGlkPScrZ3JvdXBpZCsnJndvcmQ9Jyt3b3JkXG4gICAgfSlcbiAgfSxcbiAgLyoqXG4gICAqIOeUqOaIt+eCueWHu+WPs+S4iuinkuWIhuS6q1xuICAgKi9cbiAgb25TaGFyZUFwcE1lc3NhZ2U6IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdGl0bGU6ICfmr4/kuIDmrKHlkKzlhpnvvIzkuLrkuobnprvmoqbmg7Pmm7Tov5HkuIDmraUnLFxuICAgICAgcGF0aDogJy9wYWdlcy9pbmRleC9pbmRleCcsXG4gICAgICBpbWFnZVVybDogXCJodHRwOi8vaW1nMS5waC4xMjYubmV0L2d0aWdXRVZsQTZYYlhFOWFGckIwZXc9PS8yMDk4MTE0NDc2NTAxOTIzMDExLmpwZ1wiXG4gICAgfVxuICB9XG59KVxuXG4iXX0=
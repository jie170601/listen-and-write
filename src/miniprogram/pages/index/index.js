"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const StorageUtil_1 = require("../../utils/StorageUtil");
const WordGroup_1 = require("../../beans/WordGroup");
const papaparse_1 = require("../../utils/papaparse");
var StateEnum;
(function (StateEnum) {
    StateEnum[StateEnum["WORD_UNFOLD_STATE"] = 0] = "WORD_UNFOLD_STATE";
    StateEnum[StateEnum["WORD_FOLD_STATE"] = 1] = "WORD_FOLD_STATE";
    StateEnum[StateEnum["ADD_GROUP_STATE"] = 2] = "ADD_GROUP_STATE";
    StateEnum[StateEnum["ADD_WORD_STATE"] = 3] = "ADD_WORD_STATE";
    StateEnum[StateEnum["BATCH_ADD_STATE"] = 4] = "BATCH_ADD_STATE";
})(StateEnum || (StateEnum = {}));
Page({
    data: {
        addGroupName: '',
        addWord: '',
        groupid: '',
        s: -1,
        wordGroupList: new Array(),
        State: StateEnum,
        curState: StateEnum.WORD_UNFOLD_STATE,
        preState: StateEnum.WORD_UNFOLD_STATE,
        selectData: [],
        textAreaCount: 0,
        textAreaValue: ''
    },
    onLoad() {
        this.flushPageData();
    },
    onShow() {
        this.flushPageData();
    },
    translateStateTo(nextState) {
        let preData = this.data.curState;
        this.setData({
            curState: nextState,
            preData: preData
        });
    },
    flushPageData() {
        let wordGroupList = StorageUtil_1.StorageUtil.getWordGroup();
        this.setData({
            wordGroupList: wordGroupList
        });
    },
    toAddGroup() {
        this.translateStateTo(StateEnum.ADD_GROUP_STATE);
    },
    saveAddGroup() {
        let wordGroup = new WordGroup_1.WordGroup();
        wordGroup.setCount(0);
        wordGroup.setName(this.data.addGroupName);
        StorageUtil_1.StorageUtil.addWordGroup(wordGroup);
        this.translateStateTo(StateEnum.WORD_UNFOLD_STATE);
        this.setData({
            addGroupName: ''
        });
        this.flushPageData();
    },
    cancelAddGroup() {
        this.translateStateTo(StateEnum.WORD_UNFOLD_STATE);
    },
    deleteGroup() {
    },
    saveDeleteGroup() {
        let that = this;
        wx.showModal({
            title: '提示',
            content: '确定删除吗？',
            success(res) {
                if (res.confirm) {
                    StorageUtil_1.StorageUtil.deleteWordGroup(new WordGroup_1.WordGroup());
                    that.translateStateTo(that.data.preState);
                    that.flushPageData();
                }
            }
        });
    },
    cancelDeleteGroup() {
        this.translateStateTo(this.data.preState);
    },
    addGroupNameChanged(e) {
        this.setData({
            addGroupName: e.detail.value
        });
    },
    selectChanged(e) {
        console.log(e.detail.value);
    },
    foldWordGroup(e) {
        let tapid = e.currentTarget.id;
        let groupid = this.data.groupid;
        if (groupid === tapid) {
            groupid = "";
            this.translateStateTo(StateEnum.WORD_UNFOLD_STATE);
        }
        else {
            groupid = tapid;
            this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        }
        this.setData({
            groupid: groupid
        });
    },
    toAddWord() {
        this.translateStateTo(StateEnum.ADD_WORD_STATE);
    },
    addWordChanged(e) {
        this.setData({
            addWord: e.detail.value,
            groupid: e.currentTarget.id
        });
    },
    saveAddWord() {
        let wordGroup = new WordGroup_1.WordGroup();
        let word = this.data.addWord;
        wordGroup.setId(this.data.groupid);
        StorageUtil_1.StorageUtil.addWord(wordGroup, word);
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            addWord: ''
        });
        this.flushPageData();
    },
    toAddWords() {
        this.translateStateTo(StateEnum.BATCH_ADD_STATE);
    },
    cancelAddWord() {
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            addWord: ''
        });
    },
    textAreaInput(e) {
        this.setData({
            textAreaValue: e.detail.value,
            textAreaCount: e.detail.value.length
        });
    },
    saveAddWords() {
        let words = this.data.textAreaValue;
        let wordList = papaparse_1.parse(words).data;
        let wordGroup = new WordGroup_1.WordGroup();
        wordGroup.setId(this.data.groupid);
        for (let i = 0; i < wordList.length; i++) {
            for (let j = 0; j < wordList[i].length; j++) {
                let word = wordList[i][j];
                StorageUtil_1.StorageUtil.addWord(wordGroup, word);
            }
        }
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            textAreaCount: 0,
            textAreaValue: ''
        });
        this.flushPageData();
    },
    cancelAddWords() {
        this.translateStateTo(StateEnum.WORD_FOLD_STATE);
        this.setData({
            textAreaCount: 0,
            textAreaValue: ''
        });
    },
    toDeleteWordGroup() {
        wx.navigateTo({
            url: '../delete/delete'
        });
    },
    toDeleteWord() {
        let that = this;
        wx.navigateTo({
            url: '../delete/delete?groupid=' + that.data.groupid
        });
    },
    listen() {
        let that = this;
        wx.navigateTo({
            url: '../listen/listen?groupid=' + that.data.groupid
        });
        return false;
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUtBLHlEQUFtRDtBQUluRCxxREFBaUQ7QUFFakQscURBQTJDO0FBZTNDLElBQUssU0FNSjtBQU5ELFdBQUssU0FBUztJQUNaLG1FQUFxQixDQUFBO0lBQ3JCLCtEQUFtQixDQUFBO0lBQ25CLCtEQUFtQixDQUFBO0lBQ25CLDZEQUFrQixDQUFBO0lBQ2xCLCtEQUFtQixDQUFBO0FBQ3JCLENBQUMsRUFOSSxTQUFTLEtBQVQsU0FBUyxRQU1iO0FBRUQsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osWUFBWSxFQUFDLEVBQUU7UUFDZixPQUFPLEVBQUMsRUFBRTtRQUNWLE9BQU8sRUFBQyxFQUFFO1FBQ1YsQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUNMLGFBQWEsRUFBQyxJQUFJLEtBQUssRUFBYTtRQUNwQyxLQUFLLEVBQUMsU0FBUztRQUNmLFFBQVEsRUFBRSxTQUFTLENBQUMsaUJBQWlCO1FBQ3JDLFFBQVEsRUFBQyxTQUFTLENBQUMsaUJBQWlCO1FBQ3BDLFVBQVUsRUFBQyxFQUFFO1FBQ2IsYUFBYSxFQUFDLENBQUM7UUFDZixhQUFhLEVBQUMsRUFBRTtLQUNqQjtJQUNELE1BQU07UUFDSixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDdEIsQ0FBQztJQUNELE1BQU07UUFDSixJQUFJLENBQUMsYUFBYSxFQUFFLENBQUE7SUFDdEIsQ0FBQztJQU9ELGdCQUFnQixDQUFDLFNBQW9CO1FBQ25DLElBQUksT0FBTyxHQUFhLElBQUksQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFBO1FBQzFDLElBQUksQ0FBQyxPQUFRLENBQUM7WUFDWixRQUFRLEVBQUUsU0FBUztZQUNuQixPQUFPLEVBQUMsT0FBTztTQUNoQixDQUFDLENBQUE7SUFDSixDQUFDO0lBSUQsYUFBYTtRQUNYLElBQUksYUFBYSxHQUFvQix5QkFBVyxDQUFDLFlB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QyxVQUFVLENBQUM7WUFDWixHQUFHLEVBQUUsMkJBQTJCLEdBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPO1NBQ25ELENBQUMsQ0FBQTtJQUNKLENBQUM7SUFDRCxNQUFNO1FBQ0osSUFBSSxJQUFJLEdBQU8sSUFBSSxDQUFBO1FBQ25CLEVBQUUsQ0FBQyxVQUFVLENBQUM7WUFDWixHQUFHLEVBQUUsMkJBQTJCLEdBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxPQUFPO1NBQ25ELENBQUMsQ0FBQTtRQUNGLE9BQU8sS0FBSyxDQUFBO0lBQ2QsQ0FBQztDQUNGLENBQUMsQ0FBQSIsInNvdXJjZXNDb250ZW50IjpbIi8vaW5kZXguanNcclxuLy/ojrflj5blupTnlKjlrp7kvotcclxuLy8gaW1wb3J0IHsgSU15QXBwIH0gZnJvbSAnLi4vLi4vYXBwJ1xyXG4vLyBpbXBvcnQgeyBXb3JkMk1wMyB9IGZyb20gJy4uLy4uL3V0aWxzL1dvcmQyTXAzJ1xyXG4vLyBpbXBvcnQgeyBzaG93RXJyb3JNc2cgfSBmcm9tICcuLi8uLi91dGlscy91dGlsJ1xyXG5pbXBvcnQge1N0b3JhZ2VVdGlsfSBmcm9tICcuLi8uLi91dGlscy9TdG9yYWdlVXRpbCdcclxuLy8gaW1wb3J0IHtXb3JkTGlzdH0gZnJvbSAnLi4vLi4vYmVhbi9Xb3JkTGlzdCdcclxuLy8gaW1wb3J0IHtJbmRleExpc3R9IGZyb20gJy4uLy4uL2JlYW4vSW5kZXhcclxuLy8gaW1wb3J0IHtBdWRpb1V0aWx9IGZyb20gJy4uLy4uL3V0aWxzL0F1ZGlvVXRpbCdcclxuaW1wb3J0IHsgV29yZEdyb3VwIH0gZnJvbSAnLi4vLi4vYmVhbnMvV29yZEdyb3VwJ1xyXG5pbXBvcnQgeyBXb3JkIH0gZnJvbSAnLi4vLi4vYmVhbnMvV29yZCdcclxuaW1wb3J0IHtwYXJzZX0gZnJvbSAnLi4vLi4vdXRpbHMvcGFwYXBhcnNlJ1xyXG5cclxuLy8gY29uc3QgYXBwID0gZ2V0QXBwPElNeUFwcD4oKVxyXG5cclxuLy8gY29uc3QgYXVkaW9VdGlsID0gbmV3IEF1ZGlvVXRpbCgpXHJcblxyXG4vKipcclxuICog5Zyo6L+Z5Liq6aG16Z2i5Lit77yM5pyJ5b6I5aSa5aSN5p2C55qE5pON5L2cXHJcbiAqIOe7j+W4uOimgeagueaNruW9k+WJjeaJgOWkhOeahOeKtuaAgeadpeWGs+WumuaYvuekuuS7gOS5iFxyXG4gKiDmiJbogIXmoLnmja7lvZPliY3nmoTnirbmgIHmnaXlhrPlrprmjInpkq7nmoTlip/og73mmK/ku4DkuYhcclxuICog5omA5Lul5oOz5Yiw5LqG55So5pyJ6ZmQ54q25oCB5py6XHJcbiAqIFxyXG4gKiDov5nph4zlhYjlrprkuYnkuobkuIDkuKrmnprkuL5cclxuICog5p2l5L+d5a2Y6aG16Z2i55qE5omA5pyJ54q25oCBXHJcbiAqLyBcclxuZW51bSBTdGF0ZUVudW0ge1xyXG4gIFdPUkRfVU5GT0xEX1NUQVRFID0gMCwvL+WNleivjeWIl+ihqOacquWxleW8gOeKtuaAgVxyXG4gIFdPUkRfRk9MRF9TVEFURSA9IDEsLy/ljZXor43liJfooajlsZXlvIDnirbmgIFcclxuICBBRERfR1JPVVBfU1RBVEUgPSAyLC8v5re75Yqg5YiG57uE54q25oCBXHJcbiAgQUREX1dPUkRfU1RBVEUgPSAzLC8v5re75Yqg5Y2V6K+N54q25oCBXHJcbiAgQkFUQ0hfQUREX1NUQVRFID0gNC8v5om56YeP5re75Yqg5Y2V6K+N54q25oCBXHJcbn1cclxuXHJcblBhZ2Uoe1xyXG4gIGRhdGE6IHtcclxuICAgIGFkZEdyb3VwTmFtZTonJywvL+eUqOaIt+i+k+WFpeeahOa3u+WKoOWIhue7hOWQjeensFxyXG4gICAgYWRkV29yZDonJyxcclxuICAgIGdyb3VwaWQ6JycsXHJcbiAgICBzOiAtMSxcclxuICAgIHdvcmRHcm91cExpc3Q6bmV3IEFycmF5PFdvcmRHcm91cD4oKSxcclxuICAgIFN0YXRlOlN0YXRlRW51bSxcclxuICAgIGN1clN0YXRlOiBTdGF0ZUVudW0uV09SRF9VTkZPTERfU1RBVEUsXHJcbiAgICBwcmVTdGF0ZTpTdGF0ZUVudW0uV09SRF9VTkZPTERfU1RBVEUsXHJcbiAgICBzZWxlY3REYXRhOltdLFxyXG4gICAgdGV4dEFyZWFDb3VudDowLFxyXG4gICAgdGV4dEFyZWFWYWx1ZTonJ1xyXG4gIH0sXHJcbiAgb25Mb2FkKCkge1xyXG4gICAgdGhpcy5mbHVzaFBhZ2VEYXRhKClcclxuICB9LFxyXG4gIG9uU2hvdygpe1xyXG4gICAgdGhpcy5mbHVzaFBhZ2VEYXRhKClcclxuICB9LFxyXG4gIC8qKlxyXG4gICAqIOeKtuaAgei9rOenu+WHveaVsFxyXG4gICAqIOWPr+S7peWwhuW9k+WJjeeKtuaAgei9rOenu+WIsG5leHRTYXRlXHJcbiAgICog5b2T5YmN54q25oCB5L+d5a2Y5YiwcHJlU3RhdGVcclxuICAgKiDku6XlpIfmnInkupvlnLDmlrnmgaLlpI3nirbmgIHopoHnlKjliLBcclxuICAgKi9cclxuICB0cmFuc2xhdGVTdGF0ZVRvKG5leHRTdGF0ZTogU3RhdGVFbnVtKSB7XHJcbiAgICBsZXQgcHJlRGF0YTpTdGF0ZUVudW0gPSB0aGlzLmRhdGEuY3VyU3RhdGVcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICBjdXJTdGF0ZTogbmV4dFN0YXRlLFxyXG4gICAgICBwcmVEYXRhOnByZURhdGFcclxuICAgIH0pXHJcbiAgfSxcclxuICAvKipcclxuICAgKiDliLfmlrDpobXpnaLmlbDmja7vvIzmr4/mrKHmlbDmja7mnInlj5jljJbpnIDopoHosIPnlKjmraTmlrnms5XliLfmlrDkuIDkuIvnlYzpnaJcclxuICAgKi9cclxuICBmbHVzaFBhZ2VEYXRhKCl7XHJcbiAgICBsZXQgd29yZEdyb3VwTGlzdDpBcnJheTxXb3JkR3JvdXA+ID0gU3RvcmFnZVV0aWwuZ2V0V29yZEdyb3VwKClcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICB3b3JkR3JvdXBMaXN0OndvcmRHcm91cExpc3RcclxuICAgIH0pXHJcbiAgfSxcclxuICAvKipcclxuICAgKiDmt7vliqDliIbnu4TmjInpkq7ngrnlh7vkuovku7blpITnkIZcclxuICAgKiDngrnlh7vmt7vliqDliIbnu4TlkI5cclxuICAgKiDnirbmgIHovaznp7vliLDmt7vliqDliIbnu4TnirbmgIFcclxuICAgKi9cclxuICB0b0FkZEdyb3VwKCkge1xyXG4gICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5BRERfR1JPVVBfU1RBVEUpXHJcbiAgfSxcclxuICAvKipcclxuICAgKiDkv53lrZjmt7vliqDliIbnu4TmjInpkq7ngrnlh7vkuovku7ZcclxuICAgKiDngrnlh7vkv53lrZjlkI5cclxuICAgKiAxLuS/neWtmOWIhue7hOWIsOWIhue7hOWIl+ihqFxyXG4gICAqIDIu5pu05paw6aG16Z2i5pWw5o2uXHJcbiAgICogMy7lsIbnirbmgIHovaznp7vliLDljZXor43liJfooajmnKrlsZXlvIDnirbmgIFcclxuICAgKi9cclxuICBzYXZlQWRkR3JvdXAoKSB7XHJcbiAgICBsZXQgd29yZEdyb3VwOldvcmRHcm91cCA9IG5ldyBXb3JkR3JvdXAoKVxyXG4gICAgd29yZEdyb3VwLnNldENvdW50KDApXHJcbiAgICB3b3JkR3JvdXAuc2V0TmFtZSh0aGlzLmRhdGEuYWRkR3JvdXBOYW1lKVxyXG4gICAgU3RvcmFnZVV0aWwuYWRkV29yZEdyb3VwKHdvcmRHcm91cClcclxuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uV09SRF9VTkZPTERfU1RBVEUpXHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgYWRkR3JvdXBOYW1lOicnXHJcbiAgICB9KVxyXG4gICAgdGhpcy5mbHVzaFBhZ2VEYXRhKClcclxuICB9LFxyXG4gIC8qKlxyXG4gICAqIOWPlua2iOa3u+WKoOWIhue7hOaMiemSrueCueWHu+S6i+S7tlxyXG4gICAqIOeCueWHu+WPlua2iOWQjlxyXG4gICAqIOeKtuaAgei9rOenu+WIsOWNleivjeWIl+ihqOacquWxleW8gOeKtuaAgVxyXG4gICAqL1xyXG4gIGNhbmNlbEFkZEdyb3VwKCl7XHJcbiAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLldPUkRfVU5GT0xEX1NUQVRFKVxyXG4gIH0sXHJcbiAgLyoqXHJcbiAgICog57yW6L6R5oyJ6ZKu54K55Ye75LqL5Lu2XHJcbiAgICovXHJcbiAgZGVsZXRlR3JvdXAoKXtcclxuICAgIC8vdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5ERUxFVEVfU1RBVEUpXHJcbiAgfSxcclxuICAvKipcclxuICAgKiDliKDpmaTpgInkuK3nmoTljZXor43liIbnu4TlkozljZXor41cclxuICAgKi9cclxuICBzYXZlRGVsZXRlR3JvdXAoKXtcclxuICAgIGxldCB0aGF0ID0gdGhpc1xyXG4gICAgd3guc2hvd01vZGFsKHtcclxuICAgICAgdGl0bGU6ICfmj5DnpLonLFxyXG4gICAgICBjb250ZW50OiAn56Gu5a6a5Yig6Zmk5ZCX77yfJyxcclxuICAgICAgc3VjY2VzcyhyZXMpIHtcclxuICAgICAgICBpZiAocmVzLmNvbmZpcm0pIHtcclxuICAgICAgICAgIFN0b3JhZ2VVdGlsLmRlbGV0ZVdvcmRHcm91cChuZXcgV29yZEdyb3VwKCkpXHJcbiAgICAgICAgICB0aGF0LnRyYW5zbGF0ZVN0YXRlVG8odGhhdC5kYXRhLnByZVN0YXRlKVxyXG4gICAgICAgICAgdGhhdC5mbHVzaFBhZ2VEYXRhKClcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pXHJcbiAgfSxcclxuICAvKipcclxuICAgKiDlj5bmtojnvJbovpFcclxuICAgKiDov5nph4znirbmgIHot7PovaznmoTml7blgJnmnInkuKTnp43lj6/og71cclxuICAgKiDlj6/og73ot7PovazliLDljZXor43liIbnu4TlsZXlvIDnmoTnirbmgIFcclxuICAgKiDkuZ/lj6/og73ot7PovazliLDljZXor43liIbnu4TmnKrlsZXlvIDnmoTnirbmgIFcclxuICAgKiDlhbfkvZPnmoTopoHmoLnmja7liY3pnaLnmoTnirbmgIHmnaXliKTmlq1cclxuICAgKi9cclxuICBjYW5jZWxEZWxldGVHcm91cCgpe1xyXG4gICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKHRoaXMuZGF0YS5wcmVTdGF0ZSlcclxuICB9LFxyXG4gIC8v5re75Yqg5YiG57uE6L6T5YWl5qGG6L6T5YWl5LqL5Lu25aSE55CGXHJcbiAgYWRkR3JvdXBOYW1lQ2hhbmdlZChlOmFueSl7XHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgYWRkR3JvdXBOYW1lOmUuZGV0YWlsLnZhbHVlXHJcbiAgICB9KVxyXG4gIH0sXHJcbiAgLy/nvJbovpHnirbmgIHkuIvpgInmi6nmlLnlj5jkuovku7blpITnkIZcclxuICBzZWxlY3RDaGFuZ2VkKGU6YW55KXtcclxuICAgIGNvbnNvbGUubG9nKGUuZGV0YWlsLnZhbHVlKVxyXG4gICAgLy8gdGhpcy5zZXREYXRhISh7XHJcbiAgICAvLyAgIHNlbGVjdERhdGE6ZS5kZXRhaWwudmFsdWVcclxuICAgIC8vIH0pXHJcbiAgfSxcclxuICAvKipcclxuICAgKiDlsZXlvIDmiYDngrnlh7vnmoTljZXor43liJfooahcclxuICAgKiDlubbmlLbotbflhbblroPljZXor43liJfooahcclxuICAgKiDlpoLmnpzngrnlh7vnmoTljZXor43liJfooajmnKzouqvlsLHmmK/lsZXlvIDnmoRcclxuICAgKiDpgqPkuYjlsLHmlLbotbfmiYDmnInnmoTljZXor43liJfooahcclxuICAgKiDpobXpnaLnmoTnirbmgIHku47lsZXlvIDmgIHlj5jmiJDmnKrlsZXlvIDmgIFcclxuICAgKi9cclxuICBmb2xkV29yZEdyb3VwKGU6YW55KXtcclxuICAgIGxldCB0YXBpZDpzdHJpbmcgPSBlLmN1cnJlbnRUYXJnZXQuaWRcclxuICAgIGxldCBncm91cGlkOnN0cmluZyA9IHRoaXMuZGF0YS5ncm91cGlkXHJcbiAgICBpZiAoZ3JvdXBpZCA9PT0gdGFwaWQpe1xyXG4gICAgICBncm91cGlkID0gXCJcIlxyXG4gICAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLldPUkRfVU5GT0xEX1NUQVRFKVxyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZ3JvdXBpZCA9IHRhcGlkXHJcbiAgICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uV09SRF9GT0xEX1NUQVRFKVxyXG4gICAgfVxyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIGdyb3VwaWQ6Z3JvdXBpZFxyXG4gICAgfSlcclxuICB9LFxyXG4gIHRvQWRkV29yZCgpe1xyXG4gICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5BRERfV09SRF9TVEFURSlcclxuICB9LFxyXG4gIGFkZFdvcmRDaGFuZ2VkKGU6YW55KXtcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICBhZGRXb3JkOmUuZGV0YWlsLnZhbHVlLFxyXG4gICAgICBncm91cGlkOmUuY3VycmVudFRhcmdldC5pZFxyXG4gICAgfSlcclxuICB9LFxyXG4gIHNhdmVBZGRXb3JkKCl7XHJcbiAgICBsZXQgd29yZEdyb3VwOldvcmRHcm91cCA9IG5ldyBXb3JkR3JvdXAoKVxyXG4gICAgbGV0IHdvcmQ6V29yZCA9IHRoaXMuZGF0YS5hZGRXb3JkXHJcbiAgICB3b3JkR3JvdXAuc2V0SWQodGhpcy5kYXRhLmdyb3VwaWQpXHJcbiAgICBTdG9yYWdlVXRpbC5hZGRXb3JkKHdvcmRHcm91cCwgd29yZClcclxuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uV09SRF9GT0xEX1NUQVRFKVxyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIGFkZFdvcmQ6ICcnXHJcbiAgICB9KVxyXG4gICAgdGhpcy5mbHVzaFBhZ2VEYXRhKClcclxuICB9LFxyXG4gIC8qKlxyXG4gICAqIOaJuemHj+a3u+WKoOWNleivjeaMiemSrueCueWHu+S6i+S7tuWkhOeQhlxyXG4gICAqL1xyXG4gIHRvQWRkV29yZHMoKXtcclxuICAgIHRoaXMudHJhbnNsYXRlU3RhdGVUbyhTdGF0ZUVudW0uQkFUQ0hfQUREX1NUQVRFKVxyXG4gICAgLy9jb25zb2xlLmxvZyhwYXJzZShcImEsYixjLGRkXCIpKVxyXG4gIH0sXHJcbiAgLyoqXHJcbiAgICog5b2T5Y+W5raI5re75Yqg5Y2V6K+N5oyJ6ZKu54K55Ye755qE5pe25YCZXHJcbiAgICog6ZyA6KaB5bCG54q25oCB5pS55Li65Y2V6K+N5YiG57uE5bGV5byA54q25oCBXHJcbiAgICog5bm25LiU5bCG6L6T5YWl55qE5Y2V6K+N572u5Li656m6XHJcbiAgICovXHJcbiAgY2FuY2VsQWRkV29yZCgpe1xyXG4gICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5XT1JEX0ZPTERfU1RBVEUpXHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgYWRkV29yZDogJydcclxuICAgIH0pXHJcbiAgfSxcclxuICB0ZXh0QXJlYUlucHV0KGU6YW55KXtcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICB0ZXh0QXJlYVZhbHVlOmUuZGV0YWlsLnZhbHVlLFxyXG4gICAgICB0ZXh0QXJlYUNvdW50OmUuZGV0YWlsLnZhbHVlLmxlbmd0aFxyXG4gICAgfSlcclxuICB9LFxyXG4gIC8qKlxyXG4gICAqIOaJuemHj+a3u+WKoOWNleivje+8jOS/neWtmOaMiemSrueCueWHu+S6i+S7tuWkhOeQhlxyXG4gICAqL1xyXG4gIHNhdmVBZGRXb3Jkcygpe1xyXG4gICAgbGV0IHdvcmRzOnN0cmluZyA9IHRoaXMuZGF0YS50ZXh0QXJlYVZhbHVlXHJcbiAgICBsZXQgd29yZExpc3Q6QXJyYXk8c3RyaW5nPiA9IHBhcnNlKHdvcmRzKS5kYXRhXHJcbiAgICBsZXQgd29yZEdyb3VwOldvcmRHcm91cCA9IG5ldyBXb3JkR3JvdXAoKVxyXG4gICAgd29yZEdyb3VwLnNldElkKHRoaXMuZGF0YS5ncm91cGlkKVxyXG4gICAgZm9yKGxldCBpPTA7aTx3b3JkTGlzdC5sZW5ndGg7aSsrKXtcclxuICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCB3b3JkTGlzdFtpXS5sZW5ndGg7IGorKykge1xyXG4gICAgICAgIGxldCB3b3JkOiBXb3JkID0gd29yZExpc3RbaV1bal1cclxuICAgICAgICBTdG9yYWdlVXRpbC5hZGRXb3JkKHdvcmRHcm91cCwgd29yZClcclxuICAgICAgfVxyXG4gICAgfVxyXG4gICAgdGhpcy50cmFuc2xhdGVTdGF0ZVRvKFN0YXRlRW51bS5XT1JEX0ZPTERfU1RBVEUpXHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgdGV4dEFyZWFDb3VudDowLFxyXG4gICAgICB0ZXh0QXJlYVZhbHVlOicnXHJcbiAgICB9KVxyXG4gICAgdGhpcy5mbHVzaFBhZ2VEYXRhKClcclxuICB9LCBcclxuICAvKiogIFxyXG4gICAqIOaJuemHj+a3u+WKoOWNleivje+8jOWPlua2iOaMiemSrueCueWHu+S6i+S7tuWkhOeQhlxyXG4gICAqL1xyXG4gIGNhbmNlbEFkZFdvcmRzKCl7XHJcbiAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlVG8oU3RhdGVFbnVtLldPUkRfRk9MRF9TVEFURSlcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICB0ZXh0QXJlYUNvdW50OjAsXHJcbiAgICAgIHRleHRBcmVhVmFsdWU6JydcclxuICAgIH0pXHJcbiAgfSxcclxuICAvKipcclxuICAgKiDljrvliKDpmaTljZXor43liIbnu4TpobXpnaJcclxuICAgKi9cclxuICB0b0RlbGV0ZVdvcmRHcm91cCgpe1xyXG4gICAgd3gubmF2aWdhdGVUbyh7XHJcbiAgICAgIHVybDonLi4vZGVsZXRlL2RlbGV0ZSdcclxuICAgIH0pXHJcbiAgfSxcclxuICAvKipcclxuICAgKiDljrvliKDpmaTljZXor43nlYzpnaJcclxuICAgKi9cclxuICB0b0RlbGV0ZVdvcmQoKSB7XHJcbiAgICBsZXQgdGhhdDphbnkgPSB0aGlzXHJcbiAgICB3eC5uYXZpZ2F0ZVRvKHtcclxuICAgICAgdXJsOiAnLi4vZGVsZXRlL2RlbGV0ZT9ncm91cGlkPScrdGhhdC5kYXRhLmdyb3VwaWRcclxuICAgIH0pXHJcbiAgfSxcclxuICBsaXN0ZW4oKXtcclxuICAgIGxldCB0aGF0OmFueSA9IHRoaXNcclxuICAgIHd4Lm5hdmlnYXRlVG8oe1xyXG4gICAgICB1cmw6ICcuLi9saXN0ZW4vbGlzdGVuP2dyb3VwaWQ9Jyt0aGF0LmRhdGEuZ3JvdXBpZFxyXG4gICAgfSlcclxuICAgIHJldHVybiBmYWxzZVxyXG4gIH1cclxufSlcclxuXHJcbiJdfQ==
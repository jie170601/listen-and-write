"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const Word2Mp3_1 = require("../../utils/Word2Mp3");
const StorageUtil_1 = require("../../utils/StorageUtil");
const WordGroup_1 = require("../../beans/WordGroup");
const AudioUtil_1 = require("../../utils/AudioUtil");
const Params_1 = require("../../beans/Params");
let audioUtil = new AudioUtil_1.AudioUtil(StorageUtil_1.StorageUtil.getParams());
var StateEnum;
(function (StateEnum) {
    StateEnum[StateEnum["STOP"] = 0] = "STOP";
    StateEnum[StateEnum["PLAY"] = 1] = "PLAY";
    StateEnum[StateEnum["PAUSE"] = 2] = "PAUSE";
})(StateEnum || (StateEnum = {}));
Page({
    data: {
        state: StateEnum,
        curState: StateEnum.STOP,
        downloadCount: 0,
        playCount: 0,
        wordGroup: new WordGroup_1.WordGroup(),
        wordGroupList: new Array(),
        showTopTips: false,
        errMsg: '',
        params: new Params_1.Params(),
        mode: Params_1.Mode,
        pron: Params_1.Pronunciation
    },
    onLoad(options) {
        let groupid = options.groupid;
        let wordGroup = new WordGroup_1.WordGroup();
        let wordGroupList = StorageUtil_1.StorageUtil.getWordGroup();
        let params = StorageUtil_1.StorageUtil.getParams();
        if (wordGroupList.length === 0) {
            console.log("没有单词分组");
        }
        wordGroup = wordGroupList[0];
        for (let i = 0; i < wordGroupList.length; i++) {
            if (wordGroupList[i].getId() === groupid) {
                wordGroup = wordGroupList[i];
            }
        }
        this.setData({
            params: params,
            wordGroup: wordGroup,
            wordGroupList: wordGroupList
        });
    },
    translateState(state) {
        this.setData({
            curState: state
        });
    },
    play() {
        if (this.data.curState === StateEnum.STOP) {
            try {
                let mp3Files = new Word2Mp3_1.Word2Mp3(this.data.params);
                let that = this;
                let words = this.data.wordGroup.getList();
                this.translateState(StateEnum.PLAY);
                mp3Files.getFilePaths(words, (count) => {
                    let curNumber = Math.round(count / words.length * 100);
                    that.setData({
                        downloadCount: curNumber
                    });
                }).then((paths) => {
                    console.log(paths[0]);
                    that.audioReady(paths);
                });
            }
            catch (e) {
                let that = this;
                that.setData({
                    showTopTips: true,
                    errMsg: e
                });
                setTimeout(() => {
                    that.setData({
                        showTopTips: false,
                        errMsg: ''
                    });
                }, 3000);
            }
        }
        if (this.data.curState === StateEnum.PAUSE) {
            this.translateState(StateEnum.PLAY);
            audioUtil.playOrPause();
        }
    },
    pause() {
        this.translateState(StateEnum.PAUSE);
        audioUtil.playOrPause();
    },
    audioReady(paths) {
        audioUtil.updateParams(StorageUtil_1.StorageUtil.getParams());
        audioUtil.setPaths(paths);
        audioUtil.setProccess(this.playProccess);
        audioUtil.setEnd(this.end);
        audioUtil.ready();
        audioUtil.playOrPause();
    },
    playProccess(cur) {
        let curNumber = Math.round(cur / this.data.wordGroup.getList().length * 100);
        this.setData({
            playCount: curNumber
        });
    },
    end() {
        this.setData({
            curState: StateEnum.STOP,
            downloadCount: 0,
            playCount: 0,
            showTopTips: false,
            errMsg: ''
        });
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibGlzdGVuLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsibGlzdGVuLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBRUEsbURBQStDO0FBQy9DLHlEQUFtRDtBQUNuRCxxREFBK0M7QUFFL0MscURBQStDO0FBQy9DLCtDQUE0RDtBQUU1RCxJQUFJLFNBQVMsR0FBYSxJQUFJLHFCQUFTLENBQUMseUJBQVcsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFBO0FBU2hFLElBQUssU0FJSjtBQUpELFdBQUssU0FBUztJQUNaLHlDQUFJLENBQUE7SUFDSix5Q0FBSSxDQUFBO0lBQ0osMkNBQUssQ0FBQTtBQUNQLENBQUMsRUFKSSxTQUFTLEtBQVQsU0FBUyxRQUliO0FBRUQsSUFBSSxDQUFDO0lBQ0gsSUFBSSxFQUFFO1FBQ0osS0FBSyxFQUFDLFNBQVM7UUFDZixRQUFRLEVBQUMsU0FBUyxDQUFDLElBQUk7UUFDdkIsYUFBYSxFQUFDLENBQUM7UUFDZixTQUFTLEVBQUMsQ0FBQztRQUNYLFNBQVMsRUFBQyxJQUFJLHFCQUFTLEVBQUU7UUFDekIsYUFBYSxFQUFDLElBQUksS0FBSyxFQUFjO1FBQ3JDLFdBQVcsRUFBQyxLQUFLO1FBQ2pCLE1BQU0sRUFBQyxFQUFFO1FBQ1QsTUFBTSxFQUFDLElBQUksZUFBTSxFQUFFO1FBQ25CLElBQUksRUFBQyxhQUFJO1FBQ1QsSUFBSSxFQUFDLHNCQUFhO0tBQ25CO0lBQ0QsTUFBTSxDQUFDLE9BQVc7UUFDaEIsSUFBSSxPQUFPLEdBQVUsT0FBTyxDQUFDLE9BQU8sQ0FBQTtRQUNwQyxJQUFJLFNBQVMsR0FBYyxJQUFJLHFCQUFTLEVBQUUsQ0FBQTtRQUMxQyxJQUFJLGFBQWEsR0FBcUIseUJBQVcsQ0FBQyxZQUFZLEVBQUUsQ0FBQTtRQUNoRSxJQUFJLE1BQU0sR0FBVyx5QkFBVyxDQUFDLFNBQVMsRUFBRSxDQUFBO1FBRTVDLElBQUksYUFBYSxDQUFDLE1BQU0sS0FBSyxDQUFDLEVBQUU7WUFDOUIsT0FBTyxDQUFD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LFFBQVEsQ0FBQyxLQUFLLENBQUMsQ0FBQTtRQUN6QixTQUFTLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMsQ0FBQTtRQUN4QyxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUMxQixTQUFTLENBQUMsS0FBSyxFQUFFLENBQUE7UUFDakIsU0FBUyxDQUFDLFdBQVcsRUFBRSxDQUFBO0lBQ3pCLENBQUM7SUFDRCxZQUFZLENBQUMsR0FBVTtRQUNyQixJQUFJLFNBQVMsR0FBVyxJQUFJLENBQUMsS0FBSyxDQUFDLEdBQUcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLEVBQUUsQ0FBQyxNQUFNLEdBQUcsR0FBRyxDQUFDLENBQUE7UUFDcEYsSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLFNBQVMsRUFBRSxTQUFTO1NBQ3JCLENBQUMsQ0FBQTtJQUNKLENBQUM7SUFDRCxHQUFHO1FBQ0QsSUFBSSxDQUFDLE9BQVEsQ0FBQztZQUNaLFFBQVEsRUFBQyxTQUFTLENBQUMsSUFBSTtZQUN2QixhQUFhLEVBQUMsQ0FBQztZQUNmLFNBQVMsRUFBQyxDQUFDO1lBQ1gsV0FBVyxFQUFFLEtBQUs7WUFDbEIsTUFBTSxFQUFFLEVBQUU7U0FDWCxDQUFDLENBQUE7SUFDSixDQUFDO0NBQ0YsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLy9pbmRleC5qc1xyXG4vL+iOt+WPluW6lOeUqOWunuS+i1xyXG5pbXBvcnQgeyBXb3JkMk1wMyB9IGZyb20gJy4uLy4uL3V0aWxzL1dvcmQyTXAzJ1xyXG5pbXBvcnQge1N0b3JhZ2VVdGlsfSBmcm9tICcuLi8uLi91dGlscy9TdG9yYWdlVXRpbCdcclxuaW1wb3J0IHtXb3JkR3JvdXB9IGZyb20gJy4uLy4uL2JlYW5zL1dvcmRHcm91cCdcclxuaW1wb3J0IHtXb3JkfSBmcm9tICcuLi8uLi9iZWFucy9Xb3JkJ1xyXG5pbXBvcnQge0F1ZGlvVXRpbH0gZnJvbSAnLi4vLi4vdXRpbHMvQXVkaW9VdGlsJ1xyXG5pbXBvcnQge1BhcmFtcyxNb2RlLFByb251bmNpYXRpb259IGZyb20gJy4uLy4uL2JlYW5zL1BhcmFtcydcclxuXHJcbmxldCBhdWRpb1V0aWw6QXVkaW9VdGlsID0gbmV3IEF1ZGlvVXRpbChTdG9yYWdlVXRpbC5nZXRQYXJhbXMoKSlcclxuXHJcbi8qKlxyXG4gKiDlo7DmmI7kuobkuIDkuKrmnprkuL7nsbvlnotcclxuICog55So5p2l5Yy65YiG6aG16Z2i55qE5LiJ56eN54q25oCB77yaXHJcbiAqIDEu5YGc5q2i54q25oCB77yM5Y+q5pyJ5YGc5q2i54q25oCB5Y+v5Lul5YiH5o2i5Y2V6K+N5YiX6KGo5ZKM6K+V6Z+zXHJcbiAqIDIu5pKt5pS+54q25oCB77yM5pKt5pS+54q25oCB5Y+q6IO96YCJ5oup5pqC5YGc5ZKM5YGc5q2iXHJcbiAqIDMu5pqC5YGc54q25oCB77yM5pqC5YGc54q25oCB5Y+q6IO96YCJ5oup5pKt5pS+5ZKM5YGc5q2iXHJcbiAqL1xyXG5lbnVtIFN0YXRlRW51bXtcclxuICBTVE9QLFxyXG4gIFBMQVksXHJcbiAgUEFVU0VcclxufVxyXG5cclxuUGFnZSh7XHJcbiAgZGF0YToge1xyXG4gICAgc3RhdGU6U3RhdGVFbnVtLFxyXG4gICAgY3VyU3RhdGU6U3RhdGVFbnVtLlNUT1AsXHJcbiAgICBkb3dubG9hZENvdW50OjAsXHJcbiAgICBwbGF5Q291bnQ6MCxcclxuICAgIHdvcmRHcm91cDpuZXcgV29yZEdyb3VwKCksXHJcbiAgICB3b3JkR3JvdXBMaXN0Om5ldyBBcnJheSA8V29yZEdyb3VwPigpLFxyXG4gICAgc2hvd1RvcFRpcHM6ZmFsc2UsXHJcbiAgICBlcnJNc2c6JycsXHJcbiAgICBwYXJhbXM6bmV3IFBhcmFtcygpLFxyXG4gICAgbW9kZTpNb2RlLFxyXG4gICAgcHJvbjpQcm9udW5jaWF0aW9uXHJcbiAgfSxcclxuICBvbkxvYWQob3B0aW9uczphbnkpIHtcclxuICAgIGxldCBncm91cGlkOnN0cmluZyA9IG9wdGlvbnMuZ3JvdXBpZFxyXG4gICAgbGV0IHdvcmRHcm91cDogV29yZEdyb3VwID0gbmV3IFdvcmRHcm91cCgpXHJcbiAgICBsZXQgd29yZEdyb3VwTGlzdDogQXJyYXk8V29yZEdyb3VwPiA9IFN0b3JhZ2VVdGlsLmdldFdvcmRHcm91cCgpXHJcbiAgICBsZXQgcGFyYW1zOiBQYXJhbXMgPSBTdG9yYWdlVXRpbC5nZXRQYXJhbXMoKVxyXG4gICAgLy/msqHmnInljZXor43liIbnu4TnmoTmg4XlhrXkuIvvvIzmmL7npLrliY3lvoDljZXor43nrqHnkIbpobXpnaLnmoTmjInpkq5cclxuICAgIGlmICh3b3JkR3JvdXBMaXN0Lmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICBjb25zb2xlLmxvZyhcIuayoeacieWNleivjeWIhue7hFwiKVxyXG4gICAgfVxyXG4gICAgLy/pu5jorqTmmK/nrKzkuIDkuKrljZXor43liIbnu4RcclxuICAgIHdvcmRHcm91cCA9IHdvcmRHcm91cExpc3RbMF1cclxuICAgIC8v5aaC5p6c5Y+C5pWw5Lit5Lyg5LqG5Y2V6K+N5YiG57uE55qESUTvvIzliJnpgInmi6nlj4LmlbDnmoTljZXor43liIbnu4RcclxuICAgIGZvcihsZXQgaT0wO2k8d29yZEdyb3VwTGlzdC5sZW5ndGg7aSsrKXtcclxuICAgICAgaWYod29yZEdyb3VwTGlzdFtpXS5nZXRJZCgpPT09Z3JvdXBpZCl7XHJcbiAgICAgICAgd29yZEdyb3VwID0gd29yZEdyb3VwTGlzdFtpXVxyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgcGFyYW1zOnBhcmFtcyxcclxuICAgICAgd29yZEdyb3VwOiB3b3JkR3JvdXAsXHJcbiAgICAgIHdvcmRHcm91cExpc3Q6IHdvcmRHcm91cExpc3RcclxuICAgIH0pXHJcbiAgfSxcclxuICB0cmFuc2xhdGVTdGF0ZShzdGF0ZTpTdGF0ZUVudW0pe1xyXG4gICAgdGhpcy5zZXREYXRhISh7XHJcbiAgICAgIGN1clN0YXRlOnN0YXRlXHJcbiAgICB9KVxyXG4gIH0sXHJcbiAgcGxheSgpe1xyXG4gICAgaWYgKHRoaXMuZGF0YS5jdXJTdGF0ZSA9PT0gU3RhdGVFbnVtLlNUT1ApIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgbGV0IG1wM0ZpbGVzOiBXb3JkMk1wMyA9IG5ldyBXb3JkMk1wMyh0aGlzLmRhdGEucGFyYW1zKVxyXG4gICAgICBsZXQgdGhhdCA9IHRoaXNcclxuICAgICAgbGV0IHdvcmRzOiBBcnJheTxXb3JkPiA9IHRoaXMuZGF0YS53b3JkR3JvdXAuZ2V0TGlzdCgpXHJcbiAgICAgIHRoaXMudHJhbnNsYXRlU3RhdGUoU3RhdGVFbnVtLlBMQVkpXHJcbiAgICAgIG1wM0ZpbGVzLmdldEZpbGVQYXRocyh3b3JkcywgKGNvdW50OiBudW1iZXIpID0+IHtcclxuICAgICAgICBsZXQgY3VyTnVtYmVyOiBudW1iZXIgPSBNYXRoLnJvdW5kKGNvdW50IC8gd29yZHMubGVuZ3RoICogMTAwKVxyXG4gICAgICAgIHRoYXQuc2V0RGF0YSEoe1xyXG4gICAgICAgICAgZG93bmxvYWRDb3VudDogY3VyTnVtYmVyXHJcbiAgICAgICAgfSlcclxuICAgICAgfSkudGhlbigocGF0aHM6IHN0cmluZ1tdKSA9PiB7XHJcbiAgICAgICAgY29uc29sZS5sb2cocGF0aHNbMF0pXHJcbiAgICAgICAgdGhhdC5hdWRpb1JlYWR5KHBhdGhzKVxyXG4gICAgICB9KVxyXG4gICAgfWNhdGNoKGUpe1xyXG4gICAgICBsZXQgdGhhdCA9IHRoaXNcclxuICAgICAgdGhhdC5zZXREYXRhISh7XHJcbiAgICAgICAgc2hvd1RvcFRpcHM6dHJ1ZSxcclxuICAgICAgICBlcnJNc2c6ZVxyXG4gICAgICB9KVxyXG4gICAgICBzZXRUaW1lb3V0KCgpPT57XHJcbiAgICAgICAgdGhhdC5zZXREYXRhISh7XHJcbiAgICAgICAgICBzaG93VG9wVGlwczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJNc2c6JydcclxuICAgICAgICB9KVxyXG4gICAgICB9LDMwMDApXHJcbiAgICB9XHJcbiAgICB9XHJcbiAgICBpZih0aGlzLmRhdGEuY3VyU3RhdGU9PT1TdGF0ZUVudW0uUEFVU0Upe1xyXG4gICAgICB0aGlzLnRyYW5zbGF0ZVN0YXRlKFN0YXRlRW51bS5QTEFZKVxyXG4gICAgICBhdWRpb1V0aWwucGxheU9yUGF1c2UoKVxyXG4gICAgfVxyXG4gIH0sXHJcbiAgcGF1c2UoKXtcclxuICAgIHRoaXMudHJhbnNsYXRlU3RhdGUoU3RhdGVFbnVtLlBBVVNFKVxyXG4gICAgYXVkaW9VdGlsLnBsYXlPclBhdXNlKClcclxuICB9LFxyXG4gIGF1ZGlvUmVhZHkocGF0aHM6IHN0cmluZ1tdKSB7XHJcbiAgICBhdWRpb1V0aWwudXBkYXRlUGFyYW1zKFN0b3JhZ2VVdGlsLmdldFBhcmFtcygpKVxyXG4gICAgYXVkaW9VdGlsLnNldFBhdGhzKHBhdGhzKVxyXG4gICAgYXVkaW9VdGlsLnNldFByb2NjZXNzKHRoaXMucGxheVByb2NjZXNzKVxyXG4gICAgYXVkaW9VdGlsLnNldEVuZCh0aGlzLmVuZClcclxuICAgIGF1ZGlvVXRpbC5yZWFkeSgpXHJcbiAgICBhdWRpb1V0aWwucGxheU9yUGF1c2UoKVxyXG4gIH0sXHJcbiAgcGxheVByb2NjZXNzKGN1cjpudW1iZXIpe1xyXG4gICAgbGV0IGN1ck51bWJlcjogbnVtYmVyID0gTWF0aC5yb3VuZChjdXIgLyB0aGlzLmRhdGEud29yZEdyb3VwLmdldExpc3QoKS5sZW5ndGggKiAxMDApXHJcbiAgICB0aGlzLnNldERhdGEhKHtcclxuICAgICAgcGxheUNvdW50OiBjdXJOdW1iZXJcclxuICAgIH0pXHJcbiAgfSxcclxuICBlbmQoKXtcclxuICAgIHRoaXMuc2V0RGF0YSEoe1xyXG4gICAgICBjdXJTdGF0ZTpTdGF0ZUVudW0uU1RPUCxcclxuICAgICAgZG93bmxvYWRDb3VudDowLFxyXG4gICAgICBwbGF5Q291bnQ6MCxcclxuICAgICAgc2hvd1RvcFRpcHM6IGZhbHNlLFxyXG4gICAgICBlcnJNc2c6ICcnXHJcbiAgICB9KVxyXG4gIH1cclxufSlcclxuIl19